## å‰è¨€
å‰ç«¯æ¡†æ¶å¤šå—ï¼Ÿ
å¤šï¼
å‰ç«¯UIç»„ä»¶åº“å¤šå—ï¼Ÿ
æ›´å¤šï¼
æˆ‘ä»¬éƒ½çŸ¥é“ï¼Œå‰ç«¯ç”Ÿæ€åœˆé‡Œæä¾›äº†å„è‰²å„æ ·çš„ç»„ä»¶åº“ä¾›æˆ‘ä»¬é€‰æ‹©ä½¿ç”¨ï¼Œå¤§å¤šæ•°éƒ½èƒ½æ»¡è¶³å¼€å‘è€…çš„éœ€æ±‚ï¼Œç›¸ä¿¡å¤§å®¶ä¹Ÿéƒ½ç”¨è¿‡å¾ˆå¤šã€‚

ä½†æ˜¯å®é™…ä¸Šï¼Œæ®æˆ‘äº†è§£åˆ°çš„ï¼Œç¨å¾®å¤§ä¸€äº›æœ‰è‡ªå·±äº§å“çš„å…¬å¸éƒ½ä¼šæœ‰ä¸€å¥—è‡ªå®šä¹‰çš„UIç»„ä»¶åº“ï¼Œæ»¡è¶³è‡ªèº«å¤æ‚çš„éœ€æ±‚ä¸ç»šä¸½çš„æ•ˆæœã€‚

åšä¸»ç›®å‰æ‰€åœ¨çš„å…¬å¸ä¹Ÿæœ‰ä¸€å¥—è‡ªå·±çš„äº§å“ï¼ŒPCç«¯æ‰€ç”¨çš„å‰ç«¯æ¡†æ¶æ˜¯[Angular4](https://angular.cn/).

Angular4å…¶å®ä¹Ÿæœ‰å®ƒä¸“é—¨å®šåˆ¶çš„å‰ç«¯ç»„ä»¶åº“[PrimeNg](https://www.primefaces.org/primeng/#/).å°±åƒ[Vue.js](https://cn.vuejs.org/)æœ‰[Element](http://element.eleme.io/#/zh-CN)ä¸€æ ·.

é‚£ä¹ˆæŒ‰ç†åœ¨å¼€å‘ä¸­æˆ‘ä»¬å·²ç»æœ‰äº†å‰ç«¯ç»„ä»¶åº“å¯ä»¥ä½¿ç”¨ï¼Œä¸ºä»€ä¹ˆè¿˜è¦èŠ±é‚£ä¹ˆå¤šçš„ç²¾åŠ›å’Œæ—¶é—´æ¥é‡æ–°è®¾è®¡UIç»„ä»¶å‘¢ï¼Ÿè¯ä¸å¤šè¯´ï¼Œå…ˆä¸Šå‡ å¼ å®˜æ–¹æä¾›çš„UIç»„ä»¶å›¾ï¼š

![offSwitch](https://user-gold-cdn.xitu.io/2018/10/21/16695d7a3951589a?w=80&h=37&f=png&s=577)

![onSwitch](https://user-gold-cdn.xitu.io/2018/10/21/16695d7a39606323?w=99&h=37&f=png&s=491)

ç¡®å®ä¸æ˜¯æˆ‘åæ§½,å®˜æ–¹æä¾›çš„ä¸€äº›ç»„ä»¶æ ·å¼çœŸçš„æœ‰ç‚¹å¥‡æ€ªğŸ˜­...

è™½ç„¶Angularå®˜ç½‘[ç»„ä»¶æ ·å¼](https://angular.cn/guide/component-styles)è¿™ä¸€æ–‡æ¡£ä¸­å·²ç»è¯´æ˜äº†å¯ä»¥ç”¨` ::ng-deep`æ¥è¿›è¡Œå¯¹ç»„ä»¶æ ·å¼çš„ä¿®æ”¹,ä½†ä¿®æ”¹èµ·æ¥è¿˜æ˜¯æ¯”è¾ƒéº»çƒ¦ã€‚æœ‰é‚£æ—¶é—´ï¼Œè‡ªå·±éƒ½å·²ç»æ’¸äº†ä¸€ä¸ªäº†...


ï¼ˆé¡¹ç›®ä¸­ç”¨çš„`primeng`æ˜¯`v4.2.2`ç‰ˆæœ¬çš„,ç›®å‰å·²ç»è¿­ä»£åˆ°äº†`v6.1.5`,æ‰€ä»¥ç°åœ¨å®˜ç½‘ä¸Šçœ‹åˆ°çš„`inputSwitch`ç»„ä»¶ä¼šæ¯”è¿™ä¸ªå¥½çœ‹ç‚¹ï¼‰


emmm....ä¸ºäº†è¿½æ±‚ç”¨æˆ·ä½“éªŒ(å‘¸,ç†Ÿæ‚‰`angular4`çš„ä½¿ç”¨)æ‰€ä»¥åšä¸»å†³å®šåˆ©ç”¨é—²æš‡ä¹‹ä½™è‡ªå®šä¹‰ä¸€äº›UIç»„ä»¶,ä»¥æ»¡è¶³æˆ‘ä»¬äº§å“"ä¸€äº›æ— ç¤¼çš„è¦æ±‚"ã€‚

### ä¸€ã€ç¡®å®šç»„ä»¶å­˜æ”¾çš„ä½ç½®
ä¸€ä¸ªé¡¹ç›®ä¸­ä¼šæœ‰å„ç§æ–‡ä»¶ã€æ–‡ä»¶å¤¹ï¼Œå¦‚ä½•å­˜æ”¾ç®¡ç†å¥½è¿™äº›æ–‡ä»¶çœŸçš„å¾ˆé‡è¦ã€‚ä¸ä»…ä¸ºè‡ªå·±æä¾›äº†æ–¹ä¾¿ï¼Œä¹Ÿä¸ºåæ¥çš„å¼€å‘è€…æä¾›æ–¹ä¾¿ã€‚

æ‰€ä»¥æˆ‘ä»¬åœ¨è®¾è®¡å…¬ç”¨ç»„ä»¶çš„æ—¶å€™ä¹Ÿåº”è¯¥æŠŠå®ƒä»¬éƒ½å½’ç»“åœ¨ä¸€èµ·ã€‚

æˆ‘ä¹ æƒ¯åœ¨é¡¹ç›®ä¸­æ–°å»ºä¸€ä¸ª`common`æ–‡ä»¶å¤¹ï¼Œé‡Œé¢å­˜æ”¾ä¸€äº›å…±ç”¨çš„`compoent`ï¼Œ`service`ç­‰ç­‰ã€‚
![app/common/component](https://user-gold-cdn.xitu.io/2018/10/21/16695d7a39c94b2d?w=279&h=854&f=png&s=8645)
å¦‚ä¸Šå›¾ï¼Œå¯ä»¥çœ‹åˆ°`common`æ–‡ä»¶å¤¹ä¸‹å¯¼å‡ºçš„æ˜¯ä¸€ä¸ªåä¸º`shared`çš„æ¨¡å—ã€‚
`shared`æ¨¡å—çš„åˆ›å»ºè¿‡ç¨‹ï¼š
ï¼ˆ1ï¼‰æ‰“å¼€å‘½ä»¤è¡Œ(ä½¿ç”¨vscodeç¼–è¾‘å™¨çš„å°ä¼™å¯ä»¥ç›´æ¥ä½¿ç”¨Ctrl+` å¿«æ·é”®æ‰“å¼€ç»ˆç«¯,ç„¶åä¸€è·¯è·³è½¬åˆ°commonæ–‡ä»¶å¤¹:
```
cd src\app\common
```
(2) ä½¿ç”¨åˆ›å»ºæ¨¡å—çš„æŒ‡ä»¤ï¼š
```
ng g m shared
```
å…¶å®å¾ˆå¥½ç†è§£:`ng`ä¸º`angular`ä¸€è´¯çš„æŒ‡ä»¤,`g`ä¸º`generate`åˆ›å»ºçš„ç¼©å†™,`m`ä¸º`module`æ¨¡å—çš„ç¼©å†™,åé¢æ¥ç€ä½ çš„æ¨¡å—åã€‚(åé¢åˆ›å»ºç»„ä»¶ä¹Ÿæ˜¯è¿™ä¸ªåŸç†)

åˆ›å»ºçš„æ¨¡å—å®é™…ä¸Šå¯¼å‡ºçš„æ˜¯ä¸€ä¸ªå¸¦æœ‰`@NgModule`è£…é¥°å™¨çš„ç±»è€Œå·²ï¼Œå…¶ä¸­æä¾›äº†æˆ‘ä»¬è‡ªå®šä¹‰çš„å…¬æœ‰ç»„ä»¶`component`ï¼Œå…¬æœ‰æœåŠ¡`service`ï¼Œä»¥åŠç®¡é“`pipe`ç­‰ç­‰ã€‚

### äºŒã€åˆ›å»ºç»„ä»¶
ç”±äºæˆ‘ä»¬è¦åˆ›å»ºçš„æ˜¯ä¸€ä¸ª`switch`å…¬ç”¨ç»„ä»¶ï¼Œæ‰€ä»¥åœ¨`component`æ–‡ä»¶å¤¹ä¸‹åœ¨åˆ›å»ºä¸€ä¸ªæ–‡ä»¶å¤¹`general-control`ï¼Œä¹‹å‰éƒ½æ˜¯ç›´æ¥å †ç§¯åœ¨`component`æ–‡ä»¶å¤¹ä¸‹çš„ï¼Œè¿‘æœŸå‘ç°å †å¾—æœ‰ç‚¹å¤šäº†ï¼Œæ‰€ä»¥åˆå•ç‹¬åˆ›å»ºäº†ä¸€ä¸ª`general-control`æ–‡ä»¶å¤¹æ¥å­˜æ”¾ä¸€äº›åŸºç¡€çš„å…¬ç”¨ç»„ä»¶ã€‚

æ­¤æ—¶ä½ éœ€è¦æ‰“å¼€å‘½ä»¤è¡Œ(ä½¿ç”¨vscodeç¼–è¾‘å™¨çš„å°ä¼™å¯ä»¥ç›´æ¥ä½¿ç”¨Ctrl+` å¿«æ·é”®æ‰“å¼€ç»ˆç«¯,ç„¶åä¸€è·¯è·³è½¬åˆ°general-controlæ–‡ä»¶å¤¹ï¼š
```
cd src\app\common\component\general-control
```
åœ¨æ­¤ç›®å½•ä¸‹æ‰§è¡ŒæŒ‡ä»¤ï¼š
```
ng g c switch
```
ä¸Šé¢æŒ‡ä»¤çš„æ„æ€æ˜¯åˆ›å»ºä¸€ä¸ªåä¸º`switch`çš„ç»„ä»¶ï¼ŒåŸç†å’Œåˆ›å»ºæ¨¡å—æ—¶ä¸€æ ·ã€‚

å¯ä»¥çœ‹åˆ°ç°åœ¨çš„`general-control`æ–‡ä»¶å¤¹ä¸‹å¤šå‡ºäº†ä¸€äº›ä¸œè¥¿ï¼š

![switchæ–‡ä»¶å¤¹](https://user-gold-cdn.xitu.io/2018/10/21/16695d7a3a3752d3)
æ²¡é”™,å°±æ˜¯æˆ‘ä»¬ä½¿ç”¨æŒ‡ä»¤åˆ›å»ºçš„`switch`ç»„ä»¶ã€‚

æŒ‡ä»¤ä¼šè‡ªåŠ¨å¸®ä½ ç”Ÿæˆä¸€ä¸ªæ–‡ä»¶å¤¹å’Œ4ä¸ªæ–‡ä»¶ã€‚(åŸºäº`TypeScript`çš„è¯­æ³•ï¼Œæ‰€ä»¥ç”Ÿæˆçš„`js`æ–‡ä»¶ä¹Ÿå°±æ˜¯`ts`)

å¾ˆå¥½ç†è§£ï¼Œå¯¹åº”çš„`html`æ–‡ä»¶ç¼–å†™`HTMLä»£ç `ï¼Œ`css`æ–‡ä»¶ç¼–å†™`CSSä»£ç `ï¼Œ`ts`æ–‡ä»¶ç¼–å†™`js`ä»£ç ï¼Œè‡³äº`spec.ts`æ–‡ä»¶æˆ‘ä»¬å¯ä»¥ä¸ç”¨ç®¡å®ƒã€‚

ç”±äºæˆ‘åœ¨é¡¹ç›®ä¸­ä½¿ç”¨çš„æ˜¯[sass](https://www.sass.hk/)ï¼Œæ‰€ä»¥å°†`switch.component.css`è¿™ä¸ªæ–‡ä»¶çš„åç¼€åä¿®æ”¹ä¸º`scss`ï¼ˆä½¿ç”¨äº†lessç­‰å…¶å®ƒæ‰©å±•è¯­è¨€çš„å°ä¼™åŒç†ï¼‰,å¹¶åœ¨`ts`ä¸­å¯¹`css`çš„å¼•ç”¨è¿›è¡Œä¿®æ”¹ï¼š

![scss](https://user-gold-cdn.xitu.io/2018/10/21/16695d7a3c67cca0?w=248&h=135&f=png&s=8230)
![ä¿®æ”¹ts](https://user-gold-cdn.xitu.io/2018/10/21/16695d7a3a456d11?w=891&h=264&f=png&s=24234)

ä½¿ç”¨ä¸Šé¢çš„æŒ‡ä»¤åˆ›å»ºçš„ç»„ä»¶æ˜¯ä¼šè¢«è‡ªåŠ¨å¼•ç”¨åˆ°`shared`è¿™ä¸ªæ¨¡å—ä¸­çš„ã€‚
`shared.module.ts`:
```ts
import { SwitchComponent } from './component/general-control/switch/switch.component';//æ¨¡å—ä¸­importå¼•å…¥ç»„ä»¶

@NgModule({
declarations: [
  SwitchComponent  //æ¨¡å—ä¸­å£°æ˜ç»„ä»¶
  ...
  ]
})
```

ä¸Šé¢ä¿©æ­¥æ˜¯ä½ åœ¨ä½¿ç”¨`ng g c switch`æŒ‡ä»¤æ—¶è‡ªåŠ¨å¸®ä½ å®Œæˆçš„ï¼Œä½†è‹¥æ˜¯ä½ æƒ³åœ¨å…¶å®ƒçš„æ¨¡å—ä¸­ä½¿ç”¨è¿™ä¸ª`switch`ç»„ä»¶ï¼Œè¿˜å¾—å°†å…¶å¯¼å‡ºï¼Œå¯¼å‡ºçš„æ–¹å¼æ˜¯å°†è¿™ä¸ªç»„ä»¶æ·»åŠ è‡³`shared.module.ts`æ–‡ä»¶çš„`exports`ä¸­ï¼š
```ts
import { SwitchComponent } from './component/general-control/switch/switch.component';//æ¨¡å—ä¸­importå¼•å…¥ç»„ä»¶

@NgModule({
  declarations: [
    SwitchComponent  //æ¨¡å—ä¸­å£°æ˜ç»„ä»¶
    ...
    ],
  exports: [
    SwitchComponent  //æ¨¡å—ä¸­å¯¼å‡ºç»„ä»¶
    ...
  ]
})
```
å®Œæˆä¸Šé¢çš„æ­¥éª¤ä½ å°±å¯ä»¥å®‰å¿ƒçš„æ¥å¼€å‘è‡ªå·±çš„ç»„ä»¶äº†ã€‚

### ä¸‰ã€ç¼–å†™switchç»„ä»¶
ä¸€ç•ªæŸ¥æ‰¾ï¼Œå‘ç°ç½‘ä¸Šä¹Ÿæœ‰å¾ˆå¤šè‡ªå®šä¹‰`switch`ç»„ä»¶çš„æ–‡ç« å’Œæºç ï¼Œå¯èƒ½æ˜¯å¤§å®¶éƒ½è§‰å¾—åŸç”Ÿçš„æ ·å¼ä¸å¥½çœ‹å§...
æœ‰ä½¿ç”¨`input`ç„¶åæ¥è¿›è¡Œä¿®æ”¹æ ·å¼çš„ï¼Œä¹Ÿæœ‰ç”¨å…¶å®ƒæ ‡ç­¾æ¥è‡ªå®šä¹‰çš„ã€‚
åšä¸»è¿™é‡Œæ‰¾äº†ä¸€ä¸ªæœ€ç®€å•æ–¹æ¡ˆï¼Œä¸€ä¸ª`span`æ ‡ç­¾æå®šï¼š
```html
// switch.component.html
<span class="weui-switch" [ngClass]="currentClass" [ngStyle]="style" (click)="toggle()">
    
</span>
```
åŸºç¡€css
```scss
// switch.comonent.scss
.weui-switch {
    display: inline-block;
    position: relative;
    width: 38px;
    height: 23px;
    border: 1px solid #DFDFDF;
    outline: 0;
    border-radius: 16px;
    box-sizing: border-box;
    background-color: #DFDFDF;
    transition: background-color 0.1s, border 0.1s;
    cursor: pointer;
    &.disabled{
      opacity: 0.6;
      cursor: not-allowed;
    }
  }
  .weui-switch:before {
    content: " ";
    position: absolute;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    border-radius: 15px;
    background-color: #FDFDFD;
    transition: transform 0.35s cubic-bezier(0.45, 1, 0.4, 1);
  }
  .weui-switch:after {
    content: " ";
    position: absolute;
    top: 0;
    left: 0;
    width: 56%;
    height: 97%;
    border-radius: 15px;
    background-color: #FFFFFF;
    box-shadow: 0 1px 3px rgba(0, 0, 0, 0.4);
    transition: transform 0.35s cubic-bezier(0.4, 0.4, 0.25, 1.35);
  }
  .weui-switch-on {
    border-color: #1AAD19;
    background-color: #1AAD19;
  }
  .weui-switch-on:before {
    border-color: #1AAD19;
    background-color: #1AAD19;
  }
  .weui-switch-on:after {
    transform: translateX(77%);
  }
```
æ•ˆæœå¤§æ¦‚å°±æ˜¯è¿™ä¸ªæ ·å­:
![è‡ªå®šä¹‰switchç»„ä»¶](https://user-gold-cdn.xitu.io/2018/10/21/16695d7a7efda08b?w=283&h=147&f=gif&s=13391)

ï¼ˆå½•é¢‘å¹¶è½¬æ¢GIFæ¨èä½¿ç”¨[GifGam](https://gifcam.en.softonic.com/)ï¼‰
å¯ä»¥çœ‹åˆ°ï¼Œç»„ä»¶çš„æ ·å¼è®¾è®¡å¤§å¤šéƒ½æ˜¯ä½¿ç”¨ä¼ªç±»`:after`å’Œ`:before`æ¥å®ç°çš„ï¼Œè€Œå¼€å…³çš„æ•ˆæœæ˜¯é€šè¿‡ç‚¹å‡»çš„æ—¶å€™æ·»

åŠ /ç§»é™¤`class`å`weui-switch-on`æ¥å®ç°çš„ã€‚ï¼ˆè®²jsçš„æ—¶å€™ä¼šè®²åˆ°ï¼‰

ç”±äºæˆ‘ä»¬åˆ›å»ºçš„`switch`ç»„ä»¶æ˜¯éœ€è¦åœ¨å¤šå¤„ä½¿ç”¨ï¼Œå¹¶ä¸”è¦å‘å¤–è¾“å‡ºä¸€äº›å€¼ï¼Œæ‰€ä»¥åœ¨`ts`ä¸­æˆ‘ä»¬é¦–å…ˆè¦å¼•å…¥ä¸€ä¸‹`@Input`ã€`@Output`è£…é¥°å™¨å’Œ`EventEmitter`ã€‚

```ts
import { Component, OnInit, Input, Output, EventEmitter, OnChanges } from '@angular/core';
```
å¹¶ä¸”å®šä¹‰ä¸€äº›åŸºç¡€çš„å˜é‡

```ts
  @Input() style;//{ 'width': '40px' }//å¤–éƒ¨ç»„ä»¶è¾“å…¥çš„æ ·å¼å¯¹è±¡
  @Input() isChecked: boolean = false;//å¼€å…³æ˜¯å¦æ‰“å¼€
  @Input() disabled: boolean = false;//å¼€å…³æ˜¯å¦è¢«ç¦ç”¨
  @Output() change: EventEmitter<any> = new EventEmitter();
  _isSwitch: boolean = false;
  currentClass = {}
```
æ­¤æ—¶æˆ‘ä»¬çš„`ts`å˜æˆäº†è¿™æ ·ï¼š

```ts
import { Component, OnInit, Input, Output, EventEmitter, OnChanges } from '@angular/core';

@Component({
  selector: 'app-switch',
  templateUrl: './switch.component.html',
  styleUrls: ['./switch.component.scss']
})
export class SwitchComponent implements OnInit, OnChanges {
  constructor() { }
  @Input() style;//{ 'width': '40px' }//å¤–éƒ¨ç»„ä»¶è¾“å…¥çš„æ ·å¼å¯¹è±¡
  @Input() isChecked: boolean = false;//å¤–éƒ¨ç»„ä»¶è¾“å…¥è¿›æ¥çš„ï¼šå¼€å…³æ˜¯å¦æ‰“å¼€
  @Input() disabled: boolean = false;//å¼€å…³æ˜¯å¦è¢«ç¦ç”¨
  @Output() change: EventEmitter<any> = new EventEmitter();
  _isSwitch: boolean = false;//switchç»„ä»¶æœ¬èº«çš„ï¼šå¼€å…³æ˜¯å¦æ‰“å¼€
  currentClass = {} //classé›†åˆ
  
  ngOnInit() {//åˆå§‹åŒ–ç»„ä»¶çš„ç”Ÿå‘½å‘¨æœŸ
    
  }
  ngOnChanges() {//å½“è¢«ç»‘å®šçš„è¾“å…¥å±æ€§çš„å€¼å‘ç”Ÿå˜åŒ–æ—¶è°ƒç”¨
    
  }
}
```

#### 3.1 setIsSwitch()æ–¹æ³•
ç»„ä»¶ä¸­å®šä¹‰äº†ä¿©ä¸ªâ€œå¼€å…³æ˜¯å¦æ‰“å¼€â€çš„å˜é‡`isChecked`å’Œ`_isSwitch`

ä¸€ä¸ªæ˜¯å¤–éƒ¨ç»„ä»¶ä¼ é€’è¿›æ¥çš„é»˜è®¤å€¼ï¼Œä¸€ä¸ªæ˜¯ `switch`ç»„ä»¶è‡ªèº«çš„å€¼ã€‚

æ‰€ä»¥åœ¨ç»„ä»¶è¿›è¡Œåˆå§‹åŒ–å’Œå‘ç”Ÿæ”¹å˜çš„æ—¶å€™æˆ‘ä»¬åº”è¯¥è®©å…¶ç»Ÿä¸€ï¼š

```ts
  ngOnInit() {//åˆå§‹åŒ–ç»„ä»¶çš„ç”Ÿå‘½å‘¨æœŸ
    this.setIsSwitch();
  }
  ngOnChanges() {//å½“è¢«ç»‘å®šçš„è¾“å…¥å±æ€§çš„å€¼å‘ç”Ÿå˜åŒ–æ—¶è°ƒç”¨
    this.setIsSwitch();
  }
  setIsSwitch() {//è®¾ç½®_isSwitch
    this._isSwitch = this.isChecked;
  }
```
#### 3.2 setStyle()æ–¹æ³•
ç”±äºæ˜¯è‡ªå®šä¹‰çš„ç»„ä»¶ï¼Œæˆ‘ä»¬å½“ç„¶æ˜¯å¸Œæœ›å¤§å°ä¹Ÿå¯ä»¥è‡ªå®šä¹‰ï¼Œæ‰€ä»¥æˆ‘æƒ³è¦çš„æ•ˆæœæ˜¯ï¼š

åœ¨è°ƒç”¨ç»„ä»¶çš„æ—¶å€™ï¼Œè¾“å…¥ä¸€ä¸ªå®½åº¦`width`å±æ€§ï¼Œç»„ä»¶èƒ½å¤Ÿè‡ªåŠ¨è°ƒèŠ‚å°ºå¯¸ã€‚

å› æ­¤æˆ‘åœ¨è®¾è®¡çš„æ—¶å€™å°±å®šä¹‰äº†ä¸€ä¸ª`style`å˜é‡

å®ƒæ˜¯ä¸€ä¸ªå¯¹è±¡ï¼Œå¯ä»¥å…è®¸å¼€å‘è€…è¾“å…¥ä»»æ„çš„æ ·å¼ï¼Œæ ¼å¼ä¸º`{ 'width': '40px' }`

åŒæ—¶ä¸ºäº†å‡å°‘è¾“å…¥æ ·å¼çš„å¤æ‚åº¦ï¼Œæˆ‘ä»¬è¿˜å¯ä»¥æ¥ç¼–å†™ä¸€ä¸ªæ–¹æ³•ï¼Œè®©ç»„ä»¶èƒ½å¤Ÿæ ¹æ®å®½åº¦æ¥è°ƒèŠ‚é«˜åº¦ï¼š

```
setStyle() {//è®¾ç½®æ ·å¼
    if (this.style) {
      if (this.style['width'] && !this.style['height']) {//è‹¥æ˜¯è¾“å…¥äº†å®½åº¦æ²¡æœ‰è¾“å…¥é«˜åº¦åˆ™è‡ªåŠ¨è®¡ç®—
        let width = this.getWidth(this.style['width']);
        this.style['height'] = (width * 0.55) + 'px';
      }
    }
  }
getWidth(widthStr) {//åˆ¤æ–­ç”¨æˆ·è¾“å…¥çš„widthå¸¦ä¸å¸¦pxå•ä½
    let reg = /px/;
    let width = reg.test(widthStr) ? widthStr.match(/(\d*)px/)[1] : widthStr //æ­£åˆ™è·å–ä¸å¸¦å•ä½çš„å€¼
    if (!width) width = 0;
    return width;
  }
```
å¯ä»¥çœ‹åˆ°ï¼Œä¸Šé¢æˆ‘ç¼–å†™çš„`setStyle()`æ–¹æ³•æ˜¯åˆ¤æ–­æœ‰æ²¡æœ‰å®½åº¦å’Œé«˜åº¦ï¼Œå¹¶å°†é«˜åº¦è®¾ç½®ä¸º`0.55 * width`(0.55ä¸ºæˆ‘æ‰¾åˆ°çš„æœ€åˆé€‚çš„æ¯”ä¾‹)
#### 3.3 setClass()æ–¹æ³•
å®Œæˆäº†ä¸Šé¢çš„æ­¥éª¤æˆ‘ä»¬åŸºæœ¬å°±å®Œæˆäº†å¯¹ç»„ä»¶æ ·å¼çš„åˆå§‹åŒ–ï¼Œä½†æ˜¯ï¼Œæœ€é‡è¦çš„ä¸€æ­¥å½“ç„¶æ˜¯é€šè¿‡æ·»åŠ /ç§»é™¤ä¸€äº›ç±»æ¥è¿›è¡Œç»„ä»¶çš„äº¤äº’ï¼š

```ts
 setClass() {//è½¬æ¢switchæ—¶åˆ‡æ¢class
    this.currentClass = {
      'disabled': this.disabled,
      'bg_main bor_main weui-switch-on': this._isSwitch
    }
  }
```

å¯¹è±¡`currentClass`å­˜å‚¨çš„æ˜¯ç»„ä»¶å˜åŠ¨çš„ç±»åï¼Œå¯¹è±¡çš„é”®åä¸ºç±»åï¼Œå€¼ä¸ºä¸€ä¸ªå¸ƒå°”ç±»å‹çš„å˜é‡(true / false)

é€šè¿‡å¸ƒå°”ç±»å‹çš„å˜é‡æ¥åˆ¤æ–­æ·»åŠ è¿˜æ˜¯ç§»é™¤è¿™äº›ç±»åã€‚

ç¬¬ä¸€ä¸ªç±»`disabled`è¡¨ç¤ºçš„æ˜¯å¼€å…³æ˜¯å¦è¢«ç¦ç”¨ï¼Œä¹Ÿå°±æ˜¯ç”¨æˆ·åªèƒ½æŸ¥çœ‹å¼€å…³ï¼Œå¹¶ä¸èƒ½å¯¹å…¶è¿›è¡Œæ“ä½œï¼Œå®ƒå—`disabled`å˜é‡æ§åˆ¶ã€‚

ç¬¬äºŒä¸ªç±»ä¸ºä¸‰ä¸ªç±»åçš„åˆå†™`bg_main`ã€`bor_main`ã€å’Œ`weui-switch-on`ï¼Œä»–ä»¬å—`_isSwitch`å˜é‡æ§åˆ¶ï¼Œ
ä¹Ÿå°±æ˜¯å¼€å…³æ‰“å¼€çš„æ—¶å€™åˆ™æ·»åŠ è¿™ä¸‰ä¸ªç±»ã€‚

å‰ä¿©ä¸ªç±»åæ˜¯æˆ‘åœ¨é¡¹ç›®ä¸­ä½¿ç”¨çš„â€œçš®è‚¤ç±»åâ€ï¼Œå› ä¸ºå®¢æˆ·çš„éœ€è¦ï¼Œæˆ‘ä»¬äº§å“æœ‰å‡ å¥—ä¸åŒçš„ä¸»é¢˜è‰²ï¼Œç”¨æˆ·å¯ä»¥è¿›è¡Œæ¢è‚¤åŠŸèƒ½æ¥åˆ‡æ¢ä¸»é¢˜è‰²ï¼Œå› æ­¤å°±æœ‰ä¸€äº›ç±»åéœ€è¦ç”¨æ¥æ§åˆ¶ä¸»é¢˜è‰²ã€‚

å¦‚æ©˜è‰²ä¸»é¢˜ï¼š
```scss
.bg_main {
            background-color: #ff7920!important;
}
.bor_main {
            border-color: #ff7920!important;
}
```
å½“ç„¶ï¼Œä½ è‹¥æ˜¯æ²¡æœ‰ä¸»é¢˜è‰²çš„è¯è¯·å¿½ç•¥è¿™ä¿©ä¸ªç±»ã€‚

ä¸Šé¢çš„å‡ ä¸ªæ–¹æ³•æˆ‘ä»¬éƒ½éœ€è¦åœ¨ç»„ä»¶åˆå§‹åŒ–å’Œå˜é‡å‘ç”Ÿæ”¹å˜çš„æ—¶å€™è°ƒç”¨ï¼Œæ‰€ä»¥å¯ä»¥æ•´åˆåˆ°ä¸€ä¸ªå‡½æ•°ä¸­ï¼š
```ts
  ngOnInit() {
    this.initComponent();
  }
  ngOnChanges() {
    this.initComponent();
  }
  initComponent() {
    this.setIsSwitch();
    this.setStyle();
    this.setClass();
  }
```
#### 3.4 toggle()æ–¹æ³•

å…‰æœ‰æ ·å¼å¯æ²¡ç”¨ï¼Œæˆ‘ä»¬è¿˜éœ€è¦å°†ç»„ä»¶å’Œç”¨æˆ·çš„è¡Œä¸ºç»™ç»“åˆåœ¨ä¸€èµ·ï¼Œå› æ­¤ç»™ç»„ä»¶ä¸€ä¸ª`click`äº‹ä»¶æ¥è¿›è¡Œäº¤äº’ï¼Œå¹¶ç¼–å†™`toggle()`æ–¹æ³•ï¼š

```typescript
toggle() {//åˆ‡æ¢switch
    if (this.disabled) return;//è‹¥æ˜¯ç¦ç”¨æ—¶åˆ™ç›´æ¥è¿”å›
    this._isSwitch = !this._isSwitch;
    this.isChecked = this._isSwitch;
    this.change.emit(this._isSwitch); //å‘å¤–éƒ¨ä¼ é€’æœ€æ–°çš„å€¼
  }
```
æ•´åˆåçš„`ts`æ–‡ä»¶ä¸ºè¿™æ ·ï¼š

```typescript
import { Component, OnInit, Input, Output, EventEmitter, OnChanges } from '@angular/core';

@Component({
  selector: 'app-switch',
  templateUrl: './switch.component.html',
  styleUrls: ['./switch.component.scss']
})
export class SwitchComponent implements OnInit, OnChanges {

  constructor() { }
  @Input() onLabel: string = '';//æš‚æ— 
  @Input() offLabel: string = '';
  @Input() style;//{ 'width': '40px' }//å¤–éƒ¨ç»„ä»¶è¾“å…¥çš„æ ·å¼å¯¹è±¡
  @Input() isChecked: boolean = false;//å¼€å…³æ˜¯å¦æ‰“å¼€
  @Input() disabled: boolean = false;//å¼€å…³æ˜¯å¦è¢«ç¦ç”¨
  @Output() change: EventEmitter<any> = new EventEmitter();
  _isSwitch: boolean = false;
  currentClass = {}

  ngOnInit() {
    this.initComponent();
  }
  ngOnChanges() {
    this.initComponent();
  }
  initComponent() {//åˆå§‹åŒ–å¹¶åˆ·æ–°ç»„ä»¶
    this.setIsSwitch();
    this.setStyle();
    this.setClass();
  }
  setIsSwitch() {
    this._isSwitch = this.isChecked;
  }
  setStyle() {//è®¾ç½®æ ·å¼
    if (this.style) {
      if (this.style['width'] && !this.style['height']) {//è‹¥æ˜¯è¾“å…¥äº†å®½åº¦æ²¡æœ‰è¾“å…¥é«˜åº¦åˆ™è‡ªåŠ¨è®¡ç®—
        let width = this.getWidth(this.style['width']);
        this.style['height'] = (width * 0.55) + 'px';
      }
    }
  }
  setClass() {//è½¬æ¢switchæ—¶åˆ‡æ¢class
    this.currentClass = {
      'disabled': this.disabled,
      'bg_main bor_main weui-switch-on': this._isSwitch
    }
  }
  getWidth(widthStr) {//åˆ¤æ–­ç”¨æˆ·è¾“å…¥çš„widthå¸¦ä¸å¸¦pxå•ä½
    let reg = /px/;
    let width = reg.test(widthStr) ? widthStr.match(/(\d*)px/)[1] : widthStr //æ­£åˆ™è·å–ä¸å¸¦å•ä½çš„å€¼
    if (!width) width = 0;
    return width;
  }
  toggle() {//åˆ‡æ¢switch
    if (this.disabled) return;//è‹¥æ˜¯ç¦ç”¨æ—¶åˆ™ç›´æ¥è¿”å›
    this._isSwitch = !this._isSwitch;
    this.isChecked = this._isSwitch;
    this.change.emit(this._isSwitch);
  }
}
```
### å››ã€å¼•ç”¨switchç»„ä»¶

å®Œæˆäº†ä¸Šé¢çš„éƒ¨åˆ†ï¼Œåˆ°äº†æˆ‘ä»¬æœ€æ¿€åŠ¨çš„æ—¶å€™äº†ï¼Œçœ‹çœ‹æˆ‘ä»¬äº²æ‰‹åˆ¶ä½œçš„ç»„ä»¶æœ‰æ²¡æœ‰ç”¨å§ï¼Œå“ˆå“ˆã€‚

é¦–å…ˆï¼Œåœ¨ä½¿ç”¨å…¶å®ƒç»„ä»¶çš„æ—¶å€™ï¼Œæˆ‘ä»¬è¦å°†å…¶å¼•å…¥è¿›æ¥ï¼Œç”±äºæˆ‘ä»¬æœ€å¼€å§‹æ˜¯å°†`switch`ç»„ä»¶å¼•å…¥åˆ°`shared`è¿™ä¸ªæ¨¡å—ä¸­ï¼Œå¹¶ä»è¿™ä¸ªæ¨¡å—ä¸­å¯¼å‡ºçš„ï¼Œæ‰€ä»¥æƒ³è¦åœ¨å…¶å®ƒæ¨¡å—ä¸­ä½¿ç”¨ `switch`ç»„ä»¶å°±å¾—å…ˆå¼•å…¥`shared`æ¨¡å—ã€‚

#### 4.1 å¼•å…¥sharedæ¨¡å—
æœ¬é¡¹ç›®ä¸­æœ‰å¦ä¸€ä¸ªæ¨¡å—åä¸º`coursemanage`ï¼Œç°åœ¨æˆ‘å°†å…¶ä½œä¸ºçˆ¶ç»„ä»¶æ¥å¼•ç”¨ä¸€ä¸‹`switch`ç»„ä»¶
é¦–å…ˆåœ¨æ¨¡å—é‡Œå¼•ç”¨ï¼š

```
//coursemanage.module.ts
import { NgModule } from '@angular/core';
import { SharedModule } from "./../common/shared.module";
@NgModule({
  imports: [
      SharedModule
  ]
})
export class CourseManageModule { }
```
å¼•å…¥äº†`shared`æ¨¡å—å°±ç›¸å½“äºæ˜¯å¼•å…¥é‚£ä¸ªé‚£ä¸ªæ¨¡å—ä¸­çš„æ‰€æœ‰ç»„ä»¶å’Œæ–¹æ³•ã€‚

#### 4.2 ä½¿ç”¨switchç»„ä»¶

åœ¨`coursemanage`æ¨¡å—ä¸­ï¼Œæœ‰å…¶å­ç»„ä»¶`course`è¿™ä¸ªç»„ä»¶ï¼Œåœ¨`course`ä¸­ä½¿ç”¨`switch`

```html
<!--course.component.html-->
<app-switch [isChecked]="dataStatus" (change)="changeSwitch($event)"></app-switch>
```
```ts
//course.component.ts

dataStatus: boolean = false;
changeSwitch($event) {
  this.dataStatus = $event;
}
```
æ­¤æ—¶å°±å®Œæˆäº†`switch`ç»„ä»¶çš„ç¼–å†™å’Œä½¿ç”¨ã€‚
ä½ ä¹Ÿå¯ä»¥ç»™ç»„ä»¶è®¾ç½®å¦ä¸€ä¸ªå±æ€§`disabled`:
```html
<!--course.component.html-->
<app-switch [isChecked]="dataStatus" [disable]="true" (change)="changeSwitch($event)"></app-switch>
```

### åè¯­
ä¸Šè¿°è®¾è®¡çš„switchç»„ä»¶åº”è¯¥æ˜¯UIç»„ä»¶ä¸­æ¯”è¾ƒç®€å•çš„ä¸€ç§UIç»„ä»¶äº†ï¼Œè¿˜æœ‰æ›´å¤šå¤æ‚çš„ç»„ä»¶æœ‰å¾…æˆ‘ä»¬çš„å¼€å‘ï¼Œé€šè¿‡è‡ªå·±è®¾è®¡UIç»„ä»¶ï¼Œemmm....å¯ä»¥è®©æˆ‘ä»¬æ›´æœ‰åˆ›é€ åŠ›å§åº”è¯¥è¯´ï¼Œä¹Ÿä¿ƒä½¿è‡ªå·±å¤šå»çœ‹åˆ«äººçš„åšå®¢ä¸æºç ï¼Œæœ€åå†å†™ä¸Šä¸€ç¯‡æ€»ç»“ï¼Œæˆ‘è®¤ä¸ºè¿™åº”è¯¥æ˜¯ä¸€ä¸ªæ­£å‘çš„æ¿€åŠ±ğŸ’ªï¼Œå“ˆå“ˆï¼Œå…¨ç¯‡åºŸè¯å¾ˆå¤šï¼Œä¸è¿‡è¿˜æ˜¯è¦æ„Ÿè°¢å°ä¼™çš„é˜…è¯»ğŸ™‚ã€‚