## åªè¦ä¸€ä¸ªå®å‚

### unaryå‡½æ•°

å…ˆæ¥çœ‹ä¸€ä¸ªå¥‡æ€ªçš„ä¾‹å­ï¼š

```javascript
// example1
["1","2","3"].map( parseFloat );
// [1,2,3]

["1","2","3"].map( parseInt );
// [1,NaN,NaN]
```

åœ¨ä¸Šé¢çš„ä¾‹å­ä¸­ï¼Œæˆ‘æƒ³è¦å°†ä¸€ç»„å­—ç¬¦ä¸²å…¨éƒ¨è®¾ç½®æˆæ•°å­—ç±»å‹ï¼Œä½†æ˜¯åœ¨è°ƒç”¨`parseInt`çš„æ—¶å€™ï¼Œå´å‡ºç°äº†è¿™æ ·æ€ªå¼‚çš„äº‹æƒ…ã€‚è¿™æ˜¯ä¸ºä»€ä¹ˆå‘¢ï¼Ÿ

é¦–å…ˆæˆ‘ä»¬æ¥è¯´ä¸€ä¸‹`parseInt(str,radix)`è¿™ä¸ªå‡½æ•°ï¼Œå®ƒæ¥å—ä¸¤ä¸ªå‚æ•°ï¼Œç¬¬ä¸€ä¸ªæ˜¯è¦è¢«è§£æçš„å­—ç¬¦ä¸²ï¼Œç¬¬äºŒä¸ªä¸ºå¯é€‰å‚æ•°ï¼Œè¡¨ç¤ºè¦è§£æçš„æ•°å­—çš„åŸºæ•°ã€‚è¯¥å€¼ä»‹äº 2 ~ 36 ä¹‹é—´,æ¯”å¦‚ï¼š

```javascript
parseInt("10");			//è¿”å› 10
parseInt("19",10);		//è¿”å› 19 (10+9)
parseInt("11",2);		//è¿”å› 3 (2+1)
```

- å½“å‚æ•° *radix* çš„å€¼ä¸º 0ï¼Œæˆ–æ²¡æœ‰è®¾ç½®è¯¥å‚æ•°æ—¶ï¼ŒparseInt() ä¼šæ ¹æ® *string* æ¥åˆ¤æ–­æ•°å­—çš„åŸºæ•°ã€‚
- å¦‚æœè¯¥å‚æ•°å°äº 2 æˆ–è€…å¤§äº 36ï¼Œåˆ™ parseInt() å°†è¿”å› NaNã€‚

è€Œåœ¨æ¡ˆä¾‹1ä¸­ï¼Œç”±äºæˆ‘ä»¬åœ¨è°ƒç”¨`map`çš„æ—¶å€™ï¼Œå‡½æ•°æ—¶ä¼šä¼ å…¥ä¸‰ä¸ªå®å‚ï¼š`value`ã€`index` å’Œ `list`ã€‚`parseInt()`åˆä¼šæ¥æ”¶2ä¸ªå‚æ•°ï¼Œæ‰€ä»¥æ¯æ¬¡éƒ½ç›¸å½“äºæ˜¯å°†`value`å’Œ`index`ä¼ å…¥è¿›å»äº†ã€‚è¿™æ ·å°±é€ æˆåé¢2ä¸ª`NaN`çš„æƒ…å†µã€‚

æ ¹æ®ä¸Šé¢ï¼Œæˆ‘ä»¬å¯ä»¥çœ‹åˆ°ï¼Œåœ¨å®é™…å¼€å‘ä¸­ï¼Œæˆ‘ä»¬ä¼šé¢ä¸´è¿™æ ·ä¸€ä¸ªé—®é¢˜ï¼šåœ¨è®¾è®¡ä¸€ä¸ªå®ç”¨å‡½æ•°ä¼ å…¥ä¸€ä¸ªå‡½æ•°ï¼Œè€Œè¿™ä¸ªå®ç”¨å‡½æ•°ä¼šæŠŠå¤šä¸ªå®å‚ä¼ å…¥å‡½æ•°ï¼Œä½†å¯èƒ½ä½ åªå¸Œæœ›ä½ çš„å‡½æ•°æ¥æ”¶å•ä¸€å®å‚ã€‚å¦‚ä¸Šé¢çš„`parseInt()`å‡½æ•°ï¼Œæˆ‘åœ¨è°ƒç”¨å®ƒçš„æ—¶å€™å¸Œæœ›å®ƒæ¯æ¬¡åªæ¥æ”¶ä¸€ä¸ªå‚æ•°ã€‚

æ ¹æ®ä¸Šé¢çš„éœ€è¦ï¼Œæˆ‘ä»¬æ˜¯ä¸æ˜¯å¯ä»¥æ¥å®ç°è¿™ä¹ˆä¸€ä¸ªç®€å•çš„å®ç”¨å‡½æ•°ï¼Œå®ƒåŒ…è£…ä¸€ä¸ªå‡½æ•°è°ƒç”¨ï¼Œè®©è¿™ä¸ªå‡½æ•°åœ¨æ¯æ¬¡è°ƒç”¨çš„æ—¶å€™åªæ¥æ”¶ä¸€ä¸ªå‚æ•°ï¼š

```javascript
function unary(fn) {
	return function onlyOneArg(arg) {
		return fn(arg)
	}
}

// ES6
var unary = fn => 
							arg => 
										fn(arg);
```

å¾ˆç®€å•çš„ä¸€å±‚å°è£…ï¼Œä¹Ÿå¾ˆå¥½ç†è§£ã€‚

ç°åœ¨æˆ‘ä»¬ç”¨å®ƒæ¥é…åˆä¸Šé¢çš„æ¡ˆä¾‹1:

```javascript
["1","2","3"].map( parseFloat );
// [1,2,3]

["1","2","3"].map( parseInt );
// [1,NaN,NaN]

["1","2","3"].map( unary( parseInt ) );
// [1,2,3]
```

#### sumæ¡ˆä¾‹

äº†è§£äº†ä¸Šé¢çš„`unary`å‡½æ•°ä¹‹åï¼Œæˆ‘ä»¬æ¥çœ‹ä¸€ä¸ªå¤æ‚ä¸€äº›çš„æ¡ˆä¾‹ã€‚è¿˜æ˜¯ç”¨`map`å‡½æ•°æ¥è¿›è¡Œä¸¾ä¾‹ï¼Œä¸è¿‡è¦ç”¨åˆ°æˆ‘ä»¬åœ¨ç¬¬äºŒç« è®²åˆ°çš„æ¾æ•£å‹æŸ¯é‡ŒåŒ–`looseCurry`ã€‚

```javascript
        function looseCurry(fn, arity = fn.length) { // æ¾æ•£å‹æŸ¯é‡ŒåŒ–
            return (function nextCurried(prevArgs) {
                return function curried(...nextArgs) {
                    var args = prevArgs.concat(nextArgs)
                    if (args.length >= arity) {
                        return fn(...args)
                    } else {
                        return nextCurried(args)
                    }
                }
            })([])
        }
        function sum(...args) {
            var sum = 0;
            for (let i = 0; i < args.length; i++) {
                sum += args[i];
            }
            return sum;
        }
        let adder = looseCurry(sum, 2) // ç¬¬ä¸€æ­¥ ä¼ 2è¡¨ç¤ºè‡³å°‘æ¥æ”¶2ä¸ªå‚æ•°æ‰å¯ä»¥
        let arr = [1, 2, 3, 4, 5]
        let arr2 = arr.map(adder(3)) // ç¬¬äºŒæ­¥
        console.log(arr2)
        // ç”Ÿæˆçš„ç»“æœå¾ˆæœ‰æ„æ€
        // ["41,2,3,4,5", "61,2,3,4,5", "81,2,3,4,5", "101, ...
```

å¤§å®¶å¯ä»¥å…ˆå°†è¿™æ®µä»£ç åœ¨æœ¬åœ°è·‘ä¸€ä¸‹ï¼Œå¹¶æ€è€ƒä¸ºä»€ä¹ˆä¼šå‡ºç°è¿™æ ·çš„æƒ…å†µï¼ŸğŸ¤”

å…¶å®åŸç†å¾ˆç®€å•ï¼š

åœ¨ç¬¬ä¸€æ­¥çš„æ—¶å€™ï¼Œåˆ›å»º`adder`å‡½æ•°ï¼Œåªæœ‰åœ¨æ¥æ”¶2ä¸ªåŠä»¥ä¸Šå‚æ•°æ‰ä¼šè¿è¡Œ`sum()`ï¼Œ

ç¬¬äºŒæ­¥çš„æ—¶å€™ï¼Œç”±äº`map()`ä¼šä¼ å…¥3ä¸ªå®å‚ï¼šåˆ†åˆ«æ˜¯`value`,`index`å’Œ`list`ï¼Œè€Œæ¾æ•£å‹çš„æŸ¯é‡ŒåŒ–æ˜¯å¯ä»¥æ¥æ”¶æ¯”é¢„æœŸ(è¿™é‡Œä¹Ÿå°±æ˜¯2)å¤šçš„å‚æ•°çš„ã€‚

æ‰€ä»¥åœ¨æ¯æ¬¡æ‰§è¡Œ`sum`å‡½æ•°çš„æ—¶å€™ï¼Œå®é™…ä¼ å…¥çš„éƒ½æ˜¯3ä¸ªå‚æ•°ï¼Œæ¯”å¦‚`arr`æ‰§è¡Œç¬¬ä¸€æ¬¡çš„æ—¶å€™ï¼š

```javascript
ç¬¬ä¸€æ¬¡ä¼ å…¥ï¼š
firstArg: 3,   // è°ƒç”¨adder()æ—¶ä¼ å…¥çš„3
value: 1, // æ•°ç»„ç¬¬ä¸€é¡¹çš„å€¼
index: 0, // æ•°ç»„ç¬¬ä¸€é¡¹çš„ç´¢å¼•
list: [1, 2, 3, 4, 5] // æ•´ä¸ªæ•°ç»„
// å‰é¢3é¡¹ç›¸åŠ ä¸ºæ•°å­—4ï¼Œä¹‹åæ•°å­—4ä¸æ•°ç»„åšå­—ç¬¦ä¸²ç›¸åŠ 
=> 3 + 1 + 0 + [1, 2, 3, 4, 5]
=> "41,2,3,4,5"

ç¬¬äºŒæ¬¡ä¼ å…¥
firstArg: 3,
value: 2,
index: 1,
list: [1, 2, 3, 4, 5]
```

æ­¤æ—¶ï¼Œä½¿ç”¨æˆ‘ä»¬çš„`unary`å‡½æ•°å°±å¯ä»¥è§£å†³ä¸Šé¢çš„é—®é¢˜äº†ï¼š

```javascript
let arr2 = arr.map( unary( adder(3) ) )
// [4,5,6,7,8]
```

## ä¼ ä¸€ä¸ªè¿”å›ä¸€ä¸ª

### identityå‡½æ•°

è¯´åˆ°åªä¼ ä¸€ä¸ªå®å‚çš„å‡½æ•°ï¼Œåœ¨å‡½æ•°å¼ç¼–ç¨‹å·¥å…·åº“ä¸­æœ‰å¦ä¸€ç§é€šç”¨çš„åŸºç¡€å‡½æ•°ï¼šè¯¥å‡½æ•°æ¥æ”¶ä¸€ä¸ªå®å‚ï¼Œç„¶åä»€ä¹ˆéƒ½ä¸åšï¼ŒåŸå°ä¸åŠ¨åœ°è¿”å›å®å‚å€¼ã€‚

```
function identity(v) {
	return v;
}

// ES6 ç®­å¤´å‡½æ•°å½¢å¼
var identity =
	v =>
		v;
```

ä¸¾ä¸ªä¾‹å­ï¼Œæƒ³è±¡ä¸€ä¸‹ä½ è¦ç”¨æ­£åˆ™è¡¨è¾¾å¼æ‹†åˆ†ï¼ˆsplit upï¼‰ä¸€ä¸ªå­—ç¬¦ä¸²ï¼Œä½†è¾“å‡ºçš„æ•°ç»„ä¸­å¯èƒ½åŒ…å«ä¸€äº›ç©ºå€¼ã€‚æˆ‘ä»¬å¯ä»¥ä½¿ç”¨ `filter(..)` æ•°ç»„æ–¹æ³•ï¼ˆä¸‹æ–‡ä¼šè¯¦ç»†è¯´åˆ°è¿™ä¸ªæ–¹æ³•ï¼‰æ¥ç­›é™¤ç©ºå€¼ï¼Œè€Œæˆ‘ä»¬å°† `identity(..)` å‡½æ•°ä½œä¸º `filter(..)` çš„æ–­è¨€ï¼š

```javascript
var words = "   Now is the time for all...  ".split( /\s|\b/ );
words;
// ["","Now","is","the","time","for","all","...",""]

words.filter( identity );
// ["Now","is","the","time","for","all","..."]
```

#### è½¬æ¢å‡½æ•°çš„å¦™ç”¨

å¦ä¸€ä¸ªä½¿ç”¨ `identity(..)` çš„ç¤ºä¾‹å°±æ˜¯å°†å…¶ä½œä¸ºæ›¿ä»£ä¸€ä¸ªè½¬æ¢å‡½æ•°ï¼ˆè¯‘è€…æ³¨ï¼štransformationï¼Œè¿™é‡ŒæŒ‡çš„æ˜¯å¯¹ä¼ å…¥å€¼è¿›è¡Œä¿®æ”¹æˆ–è°ƒæ•´ï¼Œè¿”å›æ–°å€¼çš„å‡½æ•°ï¼‰çš„é»˜è®¤å‡½æ•°ï¼š

```javascript
function output(msg,formatFn = identity) {
	msg = formatFn( msg );
	console.log( msg );
}

function upper(txt) {
	return txt.toUpperCase();
}

output( "Hello World", upper );		// HELLO WORLD
output( "Hello World" );			// Hello World
```

ä¸Šé¢çš„ä¾‹å­ï¼Œç›¸å½“äºæ˜¯ç»™`output`å‡½æ•°ä¸€ä¸ªé»˜è®¤çš„å‡½æ•°ï¼Œè‹¥æ˜¯æ²¡æœ‰ä¼ çš„è¯ï¼Œåˆ™åŸå°ä¸åŠ¨çš„è¿”å›ä¼ è¿›æ¥çš„`msg`ã€‚

## æ’å®šå‚æ•°

### Certain API

Certain API ç¦æ­¢ç›´æ¥ç»™æ–¹æ³•ä¼ å€¼ï¼Œè€Œè¦æ±‚æˆ‘ä»¬ä¼ å…¥ä¸€ä¸ªå‡½æ•°ï¼Œå°±ç®—è¿™ä¸ªå‡½æ•°åªæ˜¯è¿”å›ä¸€ä¸ªå€¼ã€‚JS Promise ä¸­çš„ `then(..)`æ–¹æ³•å°±æ˜¯ä¸€ä¸ª Certain APIã€‚

`then(..)`ä¸­å¿…é¡»è¦ä¼ å…¥ä¸€ä¸ªå‡½æ•°ï¼Œè€Œæœ‰æ—¶å€™æˆ‘ä»¬å¯èƒ½ä¸éœ€è¦ä¼ å…¥ä¸€ä¸ªæœ‰å®é™…ç”¨å¤„çš„å‡½æ•°ï¼Œè€Œæ˜¯ç›´æ¥è¿”å›`then`åœ¨ä¸Šä¸€æ­¥ä¸­è·å–åˆ°çš„å€¼ã€‚

æˆ–è®¸ä½ å¯ä»¥ç”¨`ES6`çš„ç®­å¤´å‡½æ•°è§£å†³è¿™ä¸ªé—®é¢˜ï¼š

```javascript
p1.then( foo ).then( () => p2 ).then( bar )
```

åœ¨ç¬¬äºŒä¸ª`then`ä¸­ç›´æ¥å°†`p2`è¿”å›ã€‚

### constantå‡½æ•°

æˆ‘ä»¬å¯ä»¥æ¥æ„é€ ä¸€ä¸ªå®ç”¨å‡½æ•°æ¥å®ç°ä¸Šé¢çš„åŠŸèƒ½ï¼š

```javascript
function constant(v) {
	return function value(){
		return v;
	};
}

// or the ES6 => form
var constant =
	v =>
		() =>
			v;
```

`constant`å‡½æ•°åŠŸèƒ½ä¹Ÿå¾ˆç®€å•ï¼Œè¿”å›ä¼ å…¥çš„å‚æ•°ã€‚

å¯¹æ¯”ï¼š

```javascript
p1.then( foo ).then( () => p2 ).then( bar );

// å¯¹æ¯”ï¼š

p1.then( foo ).then( constant( p2 ) ).then( bar );
```

ä¸¤ç§æ–¹å¼éƒ½å¯ä»¥è§£å†³`Certain API`çš„é—®é¢˜ã€‚ä½†æ˜¯æˆ‘æ›´å»ºè®®ç”¨ç¬¬äºŒç§æ–¹å¼ï¼Œè¯¥ç®­å¤´å‡½æ•°è¿”å›äº†ä¸€ä¸ªæ¥è‡ªå¤–ä½œç”¨åŸŸçš„å€¼ï¼Œè¿™å’Œ å‡½æ•°å¼ç¼–ç¨‹çš„ç†å¿µæœ‰äº›çŸ›ç›¾ã€‚åœ¨åé¢â€œå‡å°‘å‰¯ä½œç”¨â€ä¸­ä¼šæåˆ°è¯¥è¡Œä¸ºçš„ä¸è¶³ã€‚



## æ‰©å±•åœ¨å‚æ•°ä¸­çš„å¦™ç”¨

åœ¨ç¬¬ä¸€ç« ä¸­ï¼Œæˆ‘ä»¬æåˆ°äº†å½¢å‚æ•°ç»„è§£æ„ï¼š

```javascript
function foo( [x,y,...args] ) {
	console.log(x, y, args)
	// 1, 2, [3]
}

foo( [1,2,3] );
```

å½“å‡½æ•°å¿…é¡»æ¥æ”¶ä¸€ä¸ªæ•°ç»„ï¼Œè€Œä½ å´æƒ³æŠŠæ•°ç»„å†…å®¹å½“æˆå•ç‹¬å½¢å‚æ¥å¤„ç†çš„æ—¶å€™ï¼Œè¿™ä¸ªæŠ€å·§ååˆ†æœ‰ç”¨ã€‚

ç„¶è€Œï¼Œæœ‰çš„æ—¶å€™ï¼Œä½ æ— æ³•æ”¹å˜åŸå‡½æ•°çš„å®šä¹‰ï¼Œä½†æƒ³ä½¿ç”¨å½¢å‚æ•°ç»„è§£æ„ã€‚

æ¯”å¦‚ä¸‹é¢è¿™ä¸ªä¾‹å­ï¼š

```javascript
function foo(x, y) {
	console.log( x + y );
}

function bar(fn) {
	fn( [ 3, 9 ] );
}

bar( foo );
// 3,9undefined
```

ç”±äº`fn`ä¼šå°†å®å‚`[3, 9]`ä½œä¸º`x`ä¼ å…¥ï¼Œé‚£ä¹ˆ`y`å°±æ˜¯`undefined`ï¼Œæ‰€ä»¥è¾¾ä¸åˆ°æˆ‘ä»¬æœŸæœ›çš„æ•ˆæœã€‚

åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬å¯èƒ½æƒ³è¦æ”¹å˜`bar()`å‡½æ•°çš„è¡Œä¸ºï¼Œå°†`foo([3, 9])`æ”¹ä¸º`foo(â€¦[3, 9])`ï¼Œè¿™æ ·å°±èƒ½å°† `3` å’Œ `9` åˆ†åˆ«ä¼ å…¥ `foo(..)` å‡½æ•°äº†ã€‚

ä¸ºäº†è°ƒæ•´ä¸€ä¸ªå‡½æ•°ï¼Œè®©å®ƒèƒ½æŠŠæ¥æ”¶çš„å•ä¸€æ•°ç»„æ‰©å±•æˆå„è‡ªç‹¬ç«‹çš„å®å‚ï¼Œæˆ‘ä»¬å¯ä»¥å®šä¹‰ä¸€ä¸ªè¾…åŠ©å‡½æ•°ï¼š

```javascript
function spreadArgs(fn) {
	return function spreadFn(argsArr) {
		return fn( ...argsArr );
	};
}

// ES6 ç®­å¤´å‡½æ•°çš„å½¢å¼ï¼š
var spreadArgs =
	fn =>
		argsArr =>
			fn( ...argsArr );
```

**æ³¨æ„âš ï¸**ï¼š

åœ¨æˆ‘å‚è€ƒçš„æ•™æä¸­ï¼Œå°†è¿™ä¸ªè¾…åŠ©å‡½æ•°å«ä¸º`spreadArgs`ï¼Œä½†ä¸€äº›åº“ï¼Œæ¯”å¦‚ [Ramda](http://ramda.cn/)ï¼Œç»å¸¸æŠŠå®ƒå«åš `apply(..)`ã€‚

ç°åœ¨æˆ‘ä»¬å¯ä»¥ä½¿ç”¨ `spreadArgs(..)` æ¥è°ƒæ•´ `foo(..)` å‡½æ•°ï¼Œä½¿å…¶ä½œä¸ºä¸€ä¸ªåˆé€‚çš„è¾“å…¥å‚æ•°å¹¶æ­£å¸¸åœ°å·¥ä½œï¼š

```javascript
bar( spreadArgs( foo ) );			// 12
```

æœ¬è´¨ä¸Šï¼Œ`spreadArgs(..)` å‡½æ•°ä½¿æˆ‘ä»¬èƒ½å¤Ÿå®šä¹‰ä¸€ä¸ªå€ŸåŠ©æ•°ç»„ `return` å¤šä¸ªå€¼çš„å‡½æ•°ï¼Œä¸è¿‡ï¼Œå®ƒè®©è¿™äº›å€¼ä»ç„¶èƒ½åˆ†åˆ«ä½œä¸ºå…¶ä»–å‡½æ•°çš„è¾“å…¥å‚æ•°æ¥å¤„ç†ã€‚

ä¸€ä¸ªå‡½æ•°çš„è¾“å‡ºä½œä¸ºå¦å¤–ä¸€ä¸ªå‡½æ•°çš„è¾“å…¥è¢«ç§°ä½œç»„åˆï¼ˆcompositionï¼‰ï¼Œè¿™ä¸ªåœ¨åé¢çš„ç« èŠ‚ä¸­ä¼šè¯¦ç»†è¯´æ˜ã€‚

æœ‰äº†`spreadArgs`å‡½æ•°ï¼ŒåŒæ ·çš„æˆ‘ä»¬ä¹Ÿå¯ä»¥å®šä¹‰ä¸€ä¸ªä¸å®ƒåŠŸèƒ½ç›¸åçš„å‡½æ•°ï¼š

```javascript
function gatherArgs(fn) {
	return function gatheredFn(...argsArr) {
		return fn( argsArr );
	};
}

// ES6 ç®­å¤´å‡½æ•°å½¢å¼
var gatherArgs =
	fn =>
		(...argsArr) =>
			fn( argsArr );
```

> åœ¨ Ramda ä¸­ï¼Œè¯¥å®ç”¨å‡½æ•°è¢«ç§°ä½œ `unapply(..)`ï¼Œæ˜¯ä¸ `apply(..)` åŠŸèƒ½ç›¸åçš„å‡½æ•°ã€‚æˆ‘è®¤ä¸ºæœ¯è¯­ â€œæ‰©å±•ï¼ˆspreadï¼‰â€ å’Œ â€œèšé›†ï¼ˆgatherï¼‰â€ å¯ä»¥æŠŠè¿™ä¸¤ä¸ªå‡½æ•°å‘ç”Ÿçš„äº‹æƒ…è§£é‡Šå¾—æ›´å¥½ä¸€äº›ã€‚

## ä¸éœ€è¦é¡ºåºçš„æŸ¯é‡ŒåŒ–å’Œååº”ç”¨

åœ¨ä¸Šé¢ä»‹ç»çš„å¤šå½¢å‚æŸ¯é‡ŒåŒ–å’Œååº”ç”¨ä¸­ï¼Œå‚æ•°ä¼ é€’éƒ½æ˜¯æœ‰ä¸€å®šé¡ºåºçš„ã€‚å“ªä¸€ä¸ªå‚æ•°åœ¨å“ªä¸€æ­¥æ‰èƒ½ä¼ ï¼Œæ”¾åœ¨ç¬¬ä¸€ä¸ªä½ç½®éƒ½æ˜¯å›ºå®šå¥½çš„ï¼Œè¦æ˜¯æƒ³è¿›è¡Œä¿®æ­£è°ƒæ•´å¯èƒ½éœ€è¦è´¹ä¸€ç•ªåŠŸå¤«ã€‚

è¿™æ—¶å€™æˆ‘ä»¬ä¸å¾—ä¸æ€è€ƒæœ‰æ²¡æœ‰ä¸€ç§æ–¹æ³•èƒ½è®©æˆ‘ä»¬ä»ä¿®æ­£å‚æ•°é¡ºåºè¿™ä»¶äº‹é‡Œè§£è„±å‡ºæ¥å‘¢ï¼Ÿ

æˆ–è®¸**è§£æ„æ¨¡å¼**å¯ä»¥ï¼Ÿ

åœ¨ç¬¬ä¸€ç« èŠ‚ä¸­ï¼Œæˆ‘ä»¬æåˆ°äº†å‘½åå‚æ•°è§£æ„æ¨¡å¼ï¼š

```javascript
function foo( {x,y} = {} ) {
	console.log( x, y );
}

foo( {
	y: 3
} );					// undefined 3
```

å¯ä»¥çœ‹åˆ°è¿™ç§è§£æ„æ¨¡å¼å°±ç›¸å½“äºæ˜¯ä¸€ç§æ˜ å°„ï¼Œå°†è°ƒç”¨æ—¶ä¼ å…¥çš„å®å‚äºå‡½æ•°çš„å½¢å‚è¿›è¡Œä¸€ä¸ªæ˜ å°„ã€‚

å‘½åå®å‚ä¸»è¦çš„å¥½å¤„å°±æ˜¯ä¸ç”¨å†çº ç»“å®å‚ä¼ å…¥çš„é¡ºåºï¼Œå› æ­¤æé«˜äº†å¯è¯»æ€§ã€‚

### partialPropså’ŒcurryProps

æœ‰äº†è¿™æ ·çš„æƒ³æ³•ï¼Œæˆ‘ä»¬å°±å¯ä»¥æ¥é‡æ–°è°ƒæ•´ä¸€ä¸‹åŸå…ˆçš„æŸ¯é‡ŒåŒ–`curry`å’Œååº”ç”¨`partial`äº†ï¼š

```javascript
function partialProps(fn, presetArgsObj) {
    return function partialApplied(laterArgsObj) {
        return fn(Object.assign({}, presetArgsObj, laterArgsObj))
    }
}
function curryProps(fn, arity = 1) {
    return (function nextCurried(prevArgsObj) {
        return function curried(nextArgObj = {}) {
            var [key] = Object.keys(nextArgObj)
            var allArgsObj = Object.assign({}, prevArgsObj, { [key]: nextArgObj[key] })
            if (Object.keys(allArgsObj).length >= arity) {
                return fn(allArgsObj);
            }
            else {
                return nextCurried(allArgsObj)
            }
        }
    })({})
}
```

æˆ‘ä»¬ç”šè‡³ä¸éœ€è¦è®¾è®¡ä¸€ä¸ª `partialPropsRight(..)` å‡½æ•°äº†ï¼Œå› ä¸ºæˆ‘ä»¬æ ¹æœ¬ä¸éœ€è¦è€ƒè™‘å±æ€§çš„æ˜ å°„é¡ºåºï¼Œé€šè¿‡å‘½åæ¥æ˜ å°„å½¢å‚å®Œå…¨è§£å†³äº†æˆ‘ä»¬æœ‰å…³äºé¡ºåºçš„çƒ¦æ¼ï¼

ç°åœ¨å¯ä»¥æ¥è¯•è¯•è¿™ä¸¤ä¸ªæ–°å‡½æ•°ï¼š

```javascript
function foo({ x, y, z } = {}) {
	console.log( `x:${x} y:${y} z:${z}` );
}

var f1 = curryProps( foo, 3 );
var f2 = partialProps( foo, { y: 2 } );

f1( {y: 2} )( {x: 1} )( {z: 3} );
// x:1 y:2 z:3

f2( { z: 3, x: 1 } );
// x:1 y:2 z:3
```

æˆ‘ä»¬ä¸ç”¨å†ä¸ºå‚æ•°é¡ºåºè€Œçƒ¦æ¼äº†ï¼ç°åœ¨ï¼Œæˆ‘ä»¬å¯ä»¥æŒ‡å®šæˆ‘ä»¬æƒ³ä¼ å…¥çš„å®å‚ï¼Œè€Œä¸ç”¨ç®¡å®ƒä»¬çš„é¡ºåºå¦‚ä½•ã€‚ä¹Ÿä¸éœ€è¦ç±»ä¼¼ `reverseArgs(..)` çš„å‡½æ•°æˆ–å…¶å®ƒå¦¥åäº†ã€‚

### å±æ€§æ‰©å±•

ä¸Šé¢çš„`partialProps` çœ‹ä¼¼è§£å†³äº†æˆ‘ä»¬è¿™ç§å¤šå½¢å‚æ— é¡ºåºçš„é—®é¢˜ï¼Œä½†æ˜¯ï¼Œåªæœ‰åœ¨æˆ‘ä»¬å¯ä»¥æŒæ§ `foo(..)` çš„å‡½æ•°ç­¾åï¼Œå¹¶ä¸”å¯ä»¥å®šä¹‰è¯¥å‡½æ•°çš„è¡Œä¸ºï¼Œä½¿å…¶è§£æ„ç¬¬ä¸€ä¸ªå‚æ•°çš„æ—¶å€™ï¼Œä»¥ä¸ŠæŠ€æœ¯æ‰èƒ½èµ·ä½œç”¨ã€‚

å¦‚æœä¸€ä¸ªå‡½æ•°ï¼Œå…¶å½¢å‚æ˜¯å„è‡ªç‹¬ç«‹çš„ï¼ˆæ²¡æœ‰ç»è¿‡å½¢å‚è§£æ„ï¼‰ï¼Œè€Œä¸”ä¸èƒ½æ”¹å˜å®ƒçš„å‡½æ•°ç­¾åï¼Œé‚£æˆ‘ä»¬åº”è¯¥å¦‚ä½•è¿ç”¨è¿™ä¸ªæŠ€æœ¯å‘¢ï¼Ÿ

```javascript
function bar(x,y,z) {
	console.log( `x:${x} y:${y} z:${z}` );
}
```

æ¯”å¦‚ä¸Šé¢çš„`bar`å‡½æ•°ï¼Œæ¥æ”¶çš„å°±æ˜¯ä¸‰ä¸ªå‚æ•°ï¼Œä½†æ˜¯æˆ‘æƒ³è¦èƒ½æ˜ å°„åˆ°å¯¹åº”çš„ä½ç½®ï¼Œæ¯”å¦‚è¿™æ ·ä¼ ï¼š

```javascript
bar({ y: 2, x: 1, z: 3 })
```

#### spreadArgPropså‡½æ•°

å°±åƒä¹‹å‰çš„ `spreadArgs(..)` å®ç”¨å‡½æ•°ä¸€æ ·ï¼Œæˆ‘ä»¬ä¹Ÿå¯ä»¥å®šä¹‰ä¸€ä¸ª `spreadArgProps(..)` è¾…åŠ©å‡½æ•°ï¼Œå®ƒæ¥æ”¶å¯¹è±¡å®å‚çš„ `key: value` é”®å€¼å¯¹ï¼Œå¹¶å°†å…¶ â€œæ‰©å±•â€ æˆç‹¬ç«‹å®å‚ã€‚

ä¸ºäº†æ»¡è¶³ä¸Šé¢çš„éœ€æ±‚ï¼Œæˆ‘ä»¬ç°åœ¨éœ€è¦å–å¾—åœ¨è°ƒç”¨`fn`æ—¶ä¼ é€’çš„å®é™…å‚æ•°ã€‚

åœ¨`JS`çš„å‡½æ•°å¯¹è±¡ä¸Šæœ‰ä¸€ä¸ª`toString()`æ–¹æ³•ï¼Œå®ƒè¿”å›å‡½æ•°ä»£ç çš„å­—ç¬¦ä¸²å½¢å¼ï¼Œå…¶ä¸­åŒ…æ‹¬å‡½æ•°å£°æ˜çš„ç­¾åã€‚

```javascript
function spreadArgProps(
	fn,
	propOrder =
		fn.toString()
		.replace( /^(?:(?:function.*\(([^]*?)\))|(?:([^\(\)]+?)\s*=>)|(?:\(([^]*?)\)\s*=>))[^]+$/, "$1$2$3" )
		.split( /\s*,\s*/ )
		.map( v => v.replace( /[=\s].*$/, "" ) )
) {
	return function spreadFn(argsObj) {
		return fn( ...propOrder.map( k => argsObj[k] ) );
	};
}
```

è®©æˆ‘ä»¬çœ‹çœ‹ `spreadArgProps(..)` å®ç”¨å‡½æ•°æ˜¯æ€ä¹ˆç”¨çš„ï¼š

```javascript
function bar(x,y,z) {
	console.log( `x:${x} y:${y} z:${z}` );
}

var f3 = curryProps( spreadArgProps( bar ), 3 );
var f4 = partialProps( spreadArgProps( bar ), { y: 2 } );

f3( {y: 2} )( {x: 1} )( {z: 3} );
// x:1 y:2 z:3

f4( { z: 3, x: 1 } );
// x:1 y:2 z:3
```

è™½ç„¶ä¸Šé¢çš„æ–¹æ³•çœ‹ä¸Šå»æœ‰äº›ä¸é è°±ï¼Œä½†æ˜¯å®ƒç¡®å®èƒ½è§£å†³æˆ‘ä»¬å®é™…çš„é—®é¢˜ï¼Œè‡³å°‘è§£å†³äº†80%çš„æƒ…å†µã€‚

## æ— å½¢å‚é£æ ¼

åœ¨å‡½æ•°å¼ç¼–ç¨‹ä¸­ï¼Œè¿˜æœ‰ä¸€ç§æµè¡Œçš„ä»£ç é£æ ¼ï¼Œå…¶ç›®çš„æ˜¯é€šè¿‡ç§»é™¤ä¸å¿…è¦çš„å½¢å‚-å®å‚æ˜ å°„æ¥å‡å°‘è§†è§‰ä¸Šçš„å¹²æ‰°ã€‚è¿™ç§é£æ ¼çš„æ­£å¼åç§°ä¸º â€œéšæ€§ç¼–ç¨‹ï¼ˆtacit programmingï¼‰â€ï¼Œä¸€èˆ¬åˆ™ç§°ä½œ â€œæ— å½¢å‚ï¼ˆpoint-freeï¼‰â€ é£æ ¼ã€‚æœ¯è¯­ â€œpointâ€ åœ¨è¿™é‡ŒæŒ‡çš„æ˜¯å‡½æ•°å½¢å‚ã€‚

æˆ‘ä»¬ä»ä¸€ä¸ªç®€å•çš„ä¾‹å­å¼€å§‹ï¼š

```javascript
function double(x) {
	return x * 2;
}

[1,2,3,4,5].map( function mapper(v){
	return double( v );
} );
// [2,4,6,8,10]
```

å¯ä»¥çœ‹åˆ° `mapper(..)` å‡½æ•°å’Œ `double(..)` å‡½æ•°æœ‰ç›¸åŒï¼ˆæˆ–ç›¸äº’å…¼å®¹ï¼‰çš„å‡½æ•°ç­¾åã€‚å½¢å‚ï¼ˆä¹Ÿå°±æ˜¯æ‰€è°“çš„ â€œpointâ€œï¼‰`v` å¯ä»¥ç›´æ¥æ˜ å°„åˆ° `double(..)` å‡½æ•°è°ƒç”¨é‡Œç›¸åº”çš„å®å‚ä¸Šã€‚è¿™æ ·ï¼Œ`mapper(..)` å‡½æ•°åŒ…è£…å±‚æ˜¯éå¿…éœ€çš„ã€‚æˆ‘ä»¬å¯ä»¥å°†å…¶ç®€åŒ–ä¸ºæ— å½¢å‚é£æ ¼ï¼š

```javascript
function double(x) {
	return x * 2;
}

[1,2,3,4,5].map( double );
// [2,4,6,8,10]
```

è¿˜æœ‰ä¹‹å‰`parseInt()`çš„ä¾‹å­ï¼š

```javascript
["1","2","3"].map( function mapper(v){
	return parseInt( v );
} );
// [1,2,3]

=> æ— å½¢å‚é£æ ¼ï¼š
["1","2","3"].map( unary( parseInt ) );
// [1,2,3]
```

å€ŸåŠ©`unary()`å‡½æ•°ä½¿å¾—æ¯æ¬¡åªä¼ ä¸€ä¸ªå‚æ•°ã€‚

## notå‡½æ•°

é¦–å…ˆæ¥çœ‹ä¸€ä¸ªæ¡ˆä¾‹ï¼š

```javascript
function output(txt) {
	console.log( txt );
}

function printIf( predicate, msg ) {
	if (predicate( msg )) {
		output( msg );
	}
}

function isShortEnough(str) {
	return str.length <= 5;
}

var msg1 = "Hello";
var msg2 = msg1 + " World";

printIf( isShortEnough, msg1 );			// Hello
printIf( isShortEnough, msg2 );
```

æ¡ˆä¾‹å¾ˆç®€å•ï¼Œæˆ‘ä»¬è¦æ±‚å½“ä¿¡æ¯è¶³å¤Ÿé•¿æ—¶ï¼Œå°†å®ƒæ‰“å°å‡ºæ¥ï¼Œæ¢è€Œè¨€ä¹‹ï¼Œæˆ‘ä»¬éœ€è¦ä¸€ä¸ª `!isShortEnough(..)` æ–­è¨€ã€‚ä½ å¯èƒ½ä¼šé¦–å…ˆæƒ³åˆ°ï¼š

```javascript
function isLongEnough(str) {
	return !isShortEnough( str );
}

printIf( isLongEnough, msg1 );
printIf( isLongEnough, msg2 );			// Hello World
```

ä¸Šé¢çš„æ–¹å¼çœ‹ä¼¼æ˜¯å¾ˆç®€å•çš„ï¼Œä½†æ˜¯è¿˜æ˜¯éœ€è¦æˆ‘ä»¬ä¼ é€’`str`ï¼Œç°åœ¨æˆ‘ä»¬èƒ½å¦ä¸é€šè¿‡é‡æ–°å®ç° `str.length` çš„æ£€æŸ¥é€»è¾‘ï¼Œè€Œé‡æ„ä»£ç å¹¶ä½¿å…¶å˜æˆæ— å½¢å‚é£æ ¼å‘¢ï¼Ÿ

æˆ‘ä»¬å®šä¹‰ä¸€ä¸ª `not(..)` å–åè¾…åŠ©å‡½æ•°ï¼ˆåœ¨å‡½æ•°å¼ç¼–ç¨‹åº“ä¸­åˆè¢«ç§°ä½œ `complement(..)`ï¼‰ï¼š

```javascript
function not(predicate) {
	return function negated(...args){
		return !predicate( ...args );
	};
}

// ES6 ç®­å¤´å‡½æ•°å½¢å¼
var not =
	predicate =>
		(...args) =>
			!predicate( ...args );
```

ä¼ å…¥çš„`predicate`ä¸ºæ–­è¨€ï¼Œä¹Ÿå°±æ˜¯æ¡ä»¶ã€‚

ç°åœ¨æˆ‘ä»¬å¯ä»¥ç”¨`not`å‡½æ•°æ¥ä¿®æ”¹ä¸Šé¢çš„ä¾‹å­ï¼š

```javascript
var isLongEnough = not( isShortEnough )

printIf( isLongEnough, msg2 )  // Hello World
```

## whenå‡½æ•°

åˆ°ç›®å‰ä½ç½®ï¼Œä¸Šé¢çš„æ¡ˆä¾‹å·²ç»è¢«æˆ‘ä»¬ä¼˜åŒ–çš„ä¸é”™äº†ã€‚ä½†æ˜¯ä¹Ÿè®¸è¿˜èƒ½å†è¿›ä¸€æ­¥ï¼Œæˆ‘ä»¬å®é™…ä¸Šå¯ä»¥å°† `printIf(..)` å‡½æ•°æœ¬èº«é‡æ„æˆæ— å½¢å‚é£æ ¼ã€‚

æˆ‘ä»¬å¯ä»¥ç”¨ `when(..)` å®ç”¨å‡½æ•°æ¥è¡¨ç¤º `if` æ¡ä»¶å¥ï¼š

```javascript
function when (predicate, fn) {
    return function conditional (...args) {
        if (predicate(...args)) {
            return fn(...args)
        }
    }
}
// ES6
var when = (predicate, fn) => 
                (...args) => 
                    predicate(...args) ? fn(...args) : undefined
```

æˆ‘ä»¬æŠŠæœ¬ç« å‰é¢è®²åˆ°çš„å¦ä¸€äº›è¾…åŠ©å‡½æ•°å’Œ `when(..)` å‡½æ•°ç»“åˆèµ·æ¥æå®šæ— å½¢å‚é£æ ¼çš„ `printIf(..)` å‡½æ•°ï¼š

```javascript
var printIf = uncurry( partialRight( when, output ) );
```

> æˆ‘ä»¬æ˜¯è¿™ä¹ˆåšçš„ï¼šå°† `output` æ–¹æ³•å³ååº”ç”¨ä¸º `when(..)` å‡½æ•°çš„ç¬¬äºŒä¸ªï¼ˆ`fn` å½¢å‚ï¼‰å®å‚ï¼Œè¿™æ ·æˆ‘ä»¬å¾—åˆ°äº†ä¸€ä¸ªä»ç„¶æœŸæœ›æ¥æ”¶ç¬¬ä¸€ä¸ªå®å‚ï¼ˆ`predicate` å½¢å‚ï¼‰çš„å‡½æ•°ã€‚å½“**è¯¥å‡½æ•°**è¢«è°ƒç”¨æ—¶ï¼Œä¼šäº§ç”Ÿå¦ä¸€ä¸ªæœŸæœ›æ¥æ”¶ï¼ˆè¯‘è€…æ³¨ï¼šéœ€è¦è¢«æ‰“å°çš„ï¼‰ä¿¡æ¯å­—ç¬¦ä¸²çš„å‡½æ•°ï¼Œçœ‹èµ·æ¥å°±æ˜¯è¿™æ ·ï¼š`fn(predicate)(str)`ã€‚
>
> å¤šä¸ªï¼ˆä¸¤ä¸ªï¼‰é“¾å¼å‡½æ•°çš„è°ƒç”¨çœ‹èµ·æ¥å¾ˆæŒ«ï¼Œå°±åƒè¢«æŸ¯é‡ŒåŒ–çš„å‡½æ•°ã€‚äºæ˜¯æˆ‘ä»¬ç”¨ `uncurry(..)` å‡½æ•°å¤„ç†å®ƒï¼Œå¾—åˆ°ä¸€ä¸ªæœŸæœ›æ¥æ”¶ `str` å’Œ `predicate` ä¸¤ä¸ªå®å‚çš„å‡½æ•°ï¼Œè¿™æ ·è¯¥å‡½æ•°çš„ç­¾åå°±å’Œ `printIf(predicate,str)` åŸå‡½æ•°ä¸€æ ·äº†ã€‚

### printIfæ¡ˆä¾‹

ç°åœ¨æˆ‘ä»¬å¯ä»¥å°†ä¸Šé¢çš„`printIf`æ•´ç†ä¸€ä¸‹ï¼š

```javascript
function output(msg) {
	console.log( msg );
}

function isShortEnough(str) {
	return str.length <= 5;
}

var isLongEnough = not( isShortEnough );

var printIf = uncurry( partialRight( when, output ) );

var msg1 = "Hello";
var msg2 = msg1 + " World";

printIf( isShortEnough, msg1 );			// Hello
printIf( isShortEnough, msg2 );

printIf( isLongEnough, msg1 );
printIf( isLongEnough, msg2 );			// Hello World
```

### listæ¡ˆä¾‹

å®ç°åŠŸèƒ½ï¼š

è‹¥æ˜¯åˆ—è¡¨ä¸­çš„æ•°å¤§äº3åˆ™æ·»åŠ è¿›`greater`ï¼Œå¦åˆ™æ·»åŠ è¿›`less`ã€‚

è¿™ç§ç®€å•çš„æ¡ˆä¾‹è™½ç„¶å¯ä»¥ç”¨ååˆ†ç®€å•çš„æ–¹å¼æ¥å®ç°ï¼Œä½†æ˜¯ä¸ºäº†ä¹ æƒ¯å‡½æ•°å¼ç¼–ç¨‹çš„å†™æ³•ï¼Œæ‰€ä»¥ç®—æ˜¯æˆ‘åšä¸€ä¸ªå°ç»ƒä¹ å§ã€‚

```javascript
var list = [1, 2, 3, 4, 5]
var greater = []
var less = []
var isGreater = (val) => val > 3;
var pushGreater = (val) => greater.push(val);
var pushLess = (val) => less.push(val);
var handleFn = fn => uncurry( partialRight( when, fn ) )
var setGreater = handleFn( pushGreater )
var setLess = handleFn( pushLess )
function handleList (list) {
    list.forEach(val => {
        setGreater(isGreater, val)
        setLess(not(isGreater), val)
    })
    console.log('greater', greater)
    console.log('less', less)
}
handleList(list)
// greater [4, 5]
// less [1, 2, 3]
```



## æ€»ç»“

> ååº”ç”¨æ˜¯ç”¨æ¥å‡å°‘å‡½æ•°çš„å‚æ•°æ•°é‡ â€”â€” ä¸€ä¸ªå‡½æ•°æœŸæœ›æ¥æ”¶çš„å®å‚æ•°é‡ â€”â€” çš„æŠ€æœ¯ï¼Œå®ƒå‡å°‘å‚æ•°æ•°é‡çš„æ–¹å¼æ˜¯åˆ›å»ºä¸€ä¸ªé¢„è®¾äº†éƒ¨åˆ†å®å‚çš„æ–°å‡½æ•°ã€‚
>
> æŸ¯é‡ŒåŒ–æ˜¯ååº”ç”¨çš„ä¸€ç§ç‰¹æ®Šå½¢å¼ï¼Œå…¶å‚æ•°æ•°é‡é™ä½ä¸º 1ï¼Œè¿™ç§å½¢å¼åŒ…å«ä¸€ä¸²è¿ç»­çš„é“¾å¼å‡½æ•°è°ƒç”¨ï¼Œæ¯ä¸ªè°ƒç”¨æ¥æ”¶ä¸€ä¸ªå®å‚ã€‚å½“è¿™äº›é“¾å¼è°ƒç”¨æŒ‡å®šäº†æ‰€æœ‰å®å‚æ—¶ï¼ŒåŸå‡½æ•°å°±ä¼šæ‹¿åˆ°æ”¶é›†å¥½çš„å®å‚å¹¶æ‰§è¡Œã€‚ä½ åŒæ ·å¯ä»¥å°†æŸ¯é‡ŒåŒ–è¿˜åŸã€‚
>
> å…¶å®ƒç±»ä¼¼ `unary(..)`ã€`identity(..)` ä»¥åŠ `constant(..)` çš„é‡è¦å‡½æ•°æ“ä½œï¼Œæ˜¯å‡½æ•°å¼ç¼–ç¨‹åŸºç¡€å·¥å…·åº“çš„ä¸€éƒ¨åˆ†ã€‚
>
> æ— å½¢å‚æ˜¯ä¸€ç§ä¹¦å†™ä»£ç çš„é£æ ¼ï¼Œè¿™ç§é£æ ¼ç§»é™¤äº†éå¿…éœ€çš„å½¢å‚æ˜ å°„å®å‚é€»è¾‘ï¼Œå…¶ç›®çš„åœ¨äºæé«˜ä»£ç çš„å¯è¯»æ€§å’Œå¯ç†è§£æ€§ã€‚