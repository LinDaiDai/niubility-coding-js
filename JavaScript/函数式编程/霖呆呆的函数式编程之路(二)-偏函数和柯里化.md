## å‰è¨€

åœ¨ç¬¬ä¸€ç« æˆ‘ä»¬ä¸»è¦ä»‹ç»äº†å‡½æ•°çš„ä¸€äº›åŸºæœ¬åŠŸèƒ½å’Œç»“æ„ï¼Œä»¥åŠä»‹ç»äº†ä¸€äº›å®ç”¨çš„å°æŠ€å·§ã€‚è¿™äº›éƒ½æ˜¯ä¸ºäº†åé¢ä¸€æ­¥ä¸€æ­¥å…¥é—¨æ‰“ä¸‹å¥½çš„åŸºç¡€ã€‚å› ä¸ºå‡½æ•°å¼ç¼–ç¨‹å¹¶ä¸æ˜¯ä¸€ä¸ªçœ‹çœ‹æ–‡æ¡£å°±èƒ½å¾ˆå¥½æŒæ¡çš„ä¸œè¥¿ï¼Œå®ƒéœ€è¦ä½ é›†åˆå®é™…ä¾‹å­ç„¶åç†è§£æ¯ä¸€æ­¥ä¸ºä»€ä¹ˆè¦è¿™æ ·ï¼Œå¦‚æœä½ åªæ˜¯æƒ³ç²—ç•¥çš„çœ‹çœ‹ï¼Œä¸å»æ€è€ƒğŸ¤”ï¼Œç›¸ä¿¡æˆ‘ï¼Œåé¢çš„æ¡ˆä¾‹ä½ ä¼šæ„Ÿè§‰ç‰¹åˆ«è·³ï¼Œç‰¹åˆ«ç»•(å¼€å§‹å­¦ä¹ æ—¶æˆ‘å°±æ˜¯è¿™æ ·ğŸ˜¼)ã€‚

åœ¨è¿™ä¸€ç« ä¸­ï¼Œæˆ‘ä¼šé’ˆå¯¹å‡½æ•°å¼ç¼–ç¨‹çš„å¦ä¸€ä¸ªé‡ç‚¹ï¼š**å‡½æ•°çš„è¾“å…¥**æ¥åšè®²è§£å’Œæ¡ˆä¾‹åˆ†æï¼Œä¸ªäººå»ºè®®ï¼šæ‰“å¼€ä½ çš„`vscode`ï¼Œå…³ä¸Šæ–‡æ¡£ï¼ŒæŠŠæ¡ˆä¾‹æ•²ä¸Šä¸€éï¼Œéœ€è¦çš„æ—¶å€™æŠŠæ¯ä¸€æ­¥åšä¸ªå¯¹æ¯”ï¼Œç¡®ä¿è‡ªå·±æ˜¯çœŸçš„ç†è§£å®ƒä»¬ã€‚

## åå‡½æ•°

å…ˆæ¥çœ‹ä¸€ä¸ªå¤§å®¶éƒ½å¾ˆç†Ÿæ‚‰çš„å‡½æ•°ï¼š

1. ä¸€ä¸ª`ajax`å‡½æ•°ï¼Œç¬¬ä¸€ä¸ªå‚æ•°ä¸ºè¯·æ±‚çš„`API`åœ°å€ï¼Œç¬¬äºŒä¸ªä¸ºè¯·æ±‚çš„å‚æ•°ï¼Œç¬¬ä¸‰ä¸ªæ˜¯è¯·æ±‚æˆåŠŸä¹‹åçš„å›è°ƒå‡½æ•°ã€‚

```javascript
function ajax (url, data, callback) {
	// ...
}
```

2. ç°åœ¨å¦‚æœä½ å·²ç»å¾ˆç¡®å®šä¸€ä¸ª`API`åœ°å€ï¼Œæ­¤å¤–åªæ˜¯éœ€è¦ç­‰å¾…å¦å¤–ä¸¤ä¸ªå‚æ•°çš„æ—¶å€™ï¼Œæ¯”å¦‚è·å–ç”¨æˆ·ä¿¡æ¯å’Œè·å–è®¢å•è¯¦æƒ…çš„è¯·æ±‚ï¼š

```javascript
function getUser (data, cb) {
	ajax('/api/user', data, cb)
}
function getOrder (data, cb) {
	ajax('api/order', data, cb)
}
```

3. ç°åœ¨å¦‚æœä½ å·²ç»å¾ˆç¡®å®šä¸€ä¸ª`API`åœ°å€ï¼ŒåŒæ—¶å·²ç»å¾ˆç¡®å®šè¯·æ±‚çš„å‚æ•°(æ¯”å¦‚ç”¨æˆ·çš„`id`)ï¼Œæ­¤å¤–åªéœ€è¦ç­‰å¾…å¦ä¸€ä¸ªå‚æ•°çš„æ—¶å€™ï¼š

```javascript
function getCurrentUser (cb) {
	getUser({ userId: 1 }, cb)
}
function getCurrentOrder (cb) {
	getUser({ orderId: 1 }, cb)
}
```

ä¸çŸ¥é“å¤§å®¶å‘ç°äº†æ²¡ï¼Œä»ç¬¬ä¸€æ­¥åˆ°ç¬¬ä¸‰æ­¥ï¼Œæ¯è¿‡ä¸€æ­¥ï¼Œå‡½æ•°çš„å‚æ•°å°±å°‘ä¸€ä¸ªï¼Œç›´åˆ°æœ€ååªéœ€è¦ä¼ é€’ä¸€ä¸ª`cb`ã€‚

ç”¨ä¸€å¥è¯æ¥è¯´æ˜å‘ç”Ÿçš„äº‹æƒ…ï¼š`getUser(data, cb)`æ˜¯`ajax(url, data, cb)`çš„**åå‡½æ•°(partially-applied functions)**ã€‚

(æ³¨æ„âš ï¸ï¼šå‰æ–¹é«˜èƒ½ï¼)

å…³äºè¯¥æ¨¡å¼æ›´æ­£å¼çš„è¯´æ³•æ˜¯ï¼šåå‡½æ•°ä¸¥æ ¼æ¥è®²æ˜¯ä¸€ä¸ªå‡å°‘å‡½æ•°å‚æ•°ä¸ªæ•°ï¼ˆarityï¼‰çš„è¿‡ç¨‹ï¼›è¿™é‡Œçš„å‚æ•°ä¸ªæ•°æŒ‡çš„æ˜¯å¸Œæœ›ä¼ å…¥çš„å½¢å‚çš„æ•°é‡ã€‚æˆ‘ä»¬é€šè¿‡ `getUser(..)` æŠŠåŸå‡½æ•° `ajax(..)` çš„å‚æ•°ä¸ªæ•°ä» 3 ä¸ªå‡å°‘åˆ°äº† 2 ä¸ªã€‚

### partialå‡½æ•°

åœ¨ä¸Šé¢çš„ä¾‹å­ä¸­ï¼Œ`getCurrentUser(cb)`å’Œ`getCurrentOrder(cb)`çš„æ¨¡å¼å…¶å®å¾ˆæƒ³ï¼Œæˆ‘ä»¬å¯ä»¥æ¥å®šä¸€ä¸ª`partial()`å®ç”¨å‡½æ•°ï¼š

```javascript
function partial (fn, ...prestArgs) {
	return function partiallyApplied (...laterArgs) {
		return fn(...prestArgs, ...laterArgs)
	}
}
```

`partial`å‡½æ•°æ¥å—ä¸€ä¸ª`fn`å‡½æ•°ï¼Œå’Œè‹¥å¹²ä¸ªå‚æ•°`â€¦prestArgs`ã€‚

å®ƒè¿”å›çš„æ˜¯å¦ä¸€ä¸ªå‡½æ•°`partiallyApplied()`å‡½æ•°ï¼Œè¿™ä¸ªå‡½æ•°ä¹Ÿæ¥å—è‹¥å¹²ä¸ªå‚æ•°`â€¦laterArgs`ï¼Œå¹¶è¿”å›`partial`å‡½æ•°ä¼ é€’è¿›æ¥`fn`å‡½æ•°ã€‚

è¿”å›çš„`fn`å‡½æ•°ä¼šå°†`partial`å’Œ`partiallyApplied`ä¸­çš„å‚æ•°éƒ½æ¥æ”¶è¿‡å»ã€‚

(è¿™ä¸ªå®ç”¨å‡½æ•°æˆ‘è‡³å°‘æ•²äº†3é...)

å¥½å§ï¼Œæˆ‘ä»¬è¿˜æ˜¯æ¥çœ‹çœ‹æˆ‘å‚è€ƒèµ„æ–™çš„åŸç‰ˆæœ¬æ˜¯æ€ä¹ˆæè¿°è¿™ä¸ªå®ç”¨å‡½æ•°çš„å§ï¼Œæ„Ÿè§‰å®ƒè¯´çš„ä¹Ÿæ¯”è¾ƒæ¸…æ™°ï¼š

> `partial(..)` å‡½æ•°æ¥æ”¶ `fn` å‚æ•°ï¼Œæ¥è¡¨ç¤ºè¢«æˆ‘ä»¬ååº”ç”¨å®å‚ï¼ˆpartially applyï¼‰çš„å‡½æ•°ã€‚æ¥ç€ï¼Œ`fn` å½¢å‚ä¹‹åï¼Œ`presetArgs` æ•°ç»„æ”¶é›†äº†åé¢ä¼ å…¥çš„å®å‚ï¼Œä¿å­˜èµ·æ¥ç¨åä½¿ç”¨ã€‚
>
> æˆ‘ä»¬åˆ›å»ºå¹¶ `return` äº†ä¸€ä¸ªæ–°çš„å†…éƒ¨å‡½æ•°ï¼ˆä¸ºäº†æ¸…æ™°æ˜äº†ï¼Œæˆ‘ä»¬æŠŠå®ƒå‘½åä¸º`partiallyApplied(..)`ï¼‰ï¼Œè¯¥å‡½æ•°ä¸­ï¼Œ`laterArgs` æ•°ç»„æ”¶é›†äº†å…¨éƒ¨å®å‚ã€‚
>
> ä½ æ³¨æ„åˆ°åœ¨å†…éƒ¨å‡½æ•°ä¸­çš„ `fn` å’Œ `presetArgs` å¼•ç”¨äº†å—ï¼Ÿä»–ä»¬æ˜¯æ€ä¹ˆå¦‚ä½•å·¥ä½œçš„ï¼Ÿåœ¨å‡½æ•° `partial(..)` ç»“æŸè¿è¡Œåï¼Œå†…éƒ¨å‡½æ•°ä¸ºä½•è¿˜èƒ½è®¿é—® `fn` å’Œ `presetArgs` å¼•ç”¨ï¼Ÿä½ ç­”å¯¹äº†ï¼Œå°±æ˜¯å› ä¸º**é—­åŒ…**ï¼å†…éƒ¨å‡½æ•° `partiallyApplied(..)` å°é—­ï¼ˆcloses overï¼‰äº† `fn` å’Œ `presetArgs` å˜é‡ï¼Œæ‰€ä»¥æ— è®ºè¯¥å‡½æ•°åœ¨å“ªé‡Œè¿è¡Œï¼Œåœ¨ `partial(..)` å‡½æ•°è¿è¡Œåæˆ‘ä»¬ä»ç„¶å¯ä»¥è®¿é—®è¿™äº›å˜é‡ã€‚æ‰€ä»¥ç†è§£é—­åŒ…æ˜¯å¤šä¹ˆçš„é‡è¦ï¼
>
> å½“ `partiallyApplied(..)` å‡½æ•°ç¨ååœ¨æŸå¤„æ‰§è¡Œæ—¶ï¼Œè¯¥å‡½æ•°ä½¿ç”¨è¢«é—­åŒ…ä½œç”¨ï¼ˆclosed overï¼‰çš„ `fn` å¼•ç”¨æ¥æ‰§è¡ŒåŸå‡½æ•°ï¼Œé¦–å…ˆä¼ å…¥ï¼ˆè¢«é—­åŒ…ä½œç”¨çš„ï¼‰`presetArgs` æ•°ç»„ä¸­æ‰€æœ‰çš„ååº”ç”¨ï¼ˆpartial applicationï¼‰å®å‚ï¼Œç„¶åå†è¿›ä¸€æ­¥ä¼ å…¥ `laterArgs` æ•°ç»„ä¸­çš„å®å‚ã€‚

å½“ç„¶ä½ ä¹Ÿå¯ä»¥ç”¨æ›´ä¾¿æ·çš„ç®­å¤´å‡½æ•°è¯­æ³•æ¥é‡å†™ä¸Šé¢çš„å‡½æ•°ï¼š

```javascript
var partial = (fn, ...presetArgs) => 
														(...laterArgs) => 
																fn(...prestArgs, ...laterArgs);
```

**ä¼˜ç‚¹**ï¼šæ›´åŠ ç®€æ´ï¼Œç”šè‡³ä»£ç ç¨€å°‘ã€‚

**ç¼ºç‚¹**ï¼šå‡½æ•°ä¼šå˜æˆåŒ¿åå‡½æ•°ï¼Œå¯è¯»æ€§ä¸Šå¤±å»ç›Šå¤„ï¼Œæ­¤å¤–ï¼Œç”±äºä½œç”¨åŸŸè¾¹ç•Œå˜å¾—æ¨¡ç³Šï¼Œæˆ‘ä»¬ä¼šæ›´åŠ éš¾ä»¥è¾©è®¤é—­åŒ…ã€‚

ä¸è¿‡æ˜¯å¦é‡‡ç”¨ç®­å¤´å‡½æ•°éƒ½æ˜¯ä½ çš„ä¸ªäººå–œå¥½ã€‚

### ajaxæ¡ˆä¾‹

1. ä»‹ç»å®Œä¸Šé¢çš„å‡½æ•°ï¼Œæˆ‘ä»¬ç°åœ¨å¯ä»¥ç”¨`partial`å®ç”¨å‡½æ•°æ¥åˆ¶é€ è¿™äº›ä¹‹å‰æåŠçš„åå‡½æ•°ï¼š

```javascript
// example1
function partial (fn, ...prestArgs) {
	return function partiallyApplied (...laterArgs) {
		return fn(...prestArgs, ...laterArgs)
	}
}

var getUser = partial(ajax, '/api/user')

var getOrder = partial(ajax, '/api/order')
```

ä¸çŸ¥é“å¤§å®¶è„‘ä¸­æ˜¯å¦æœ‰`getUser` å‡½æ•°çš„å¤–å½¢å’Œå†…åœ¨ï¼Œå®ƒå…¶å®å°±ç›¸å½“äºè¿™æ ·ï¼š

```javascript
var getUser = partial(ajax, '/api/user')
// ç›¸å½“äº=>
var getUser = function partailApplication (...laterArgs) {
  return ajax('/api/user', ...laterArgs)
}
```

2. æˆ‘ç›¸ä¿¡å¤§å®¶å·²ç»çŸ¥é“æ€æ ·ç”¨`partial`æ¥å†™`getUser`å‡½æ•°äº†

é‚£ä¹ˆå†è¿›ä¸€å±‚ï¼Œ`getCurrentuser`å‡½æ•°å¯ä»¥æ€ä¹ˆå†™å‘¢ï¼Ÿ

```javascript
// example2
var getCurrentUser = partial(ajax, '/api/user', { userId: 1 })
```

å“ˆå“ˆğŸ˜„ï¼Œçœ‹åˆ°è¿™é‡Œä½ æ˜¯å¦æƒ³åˆ°äº†è¿˜èƒ½ç”¨æ¡ˆä¾‹1ä¸­çš„`getUser`å’Œ`partial`é…åˆï¼š

```javascript
// example3
var getCurrentUser = partial(getUser, { userId: 1 })
```

è¿‡ç¨‹æ˜¯è¿™æ ·çš„ï¼š

```javascript
function ajax (url, data, callback) {
	// ...
}

function partial (fn, ...prestArgs) {
	return function partiallyApplied (...laterArgs) {
		return fn(...prestArgs, ...laterArgs)
	}
}

var getUser = partial(ajax, '/api/user')

var getCurrentUser = partial(getUser, { userId: 1 })
```

æˆ‘ä»¬å¯ä»¥åƒæ¡ˆä¾‹2ä¸€æ ·é€šè¿‡æŒ‡å®š`url`å’Œ`data`ä¸¤ä¸ªå®å‚æ¥å®šä¹‰`getCurrentUser(...)`å‡½æ•°ã€‚

ä¹Ÿå¯ä»¥åƒæ¡ˆä¾‹3å°†`getCurrentUser(â€¦)`å‡½æ•°å®šä¹‰æˆ`getUser(â€¦)`çš„ååº”ç”¨ï¼Œè¯¥ååº”ç”¨ä»…æŒ‡å®šä¸€ä¸ªé™„åŠ çš„ `data` å®å‚ã€‚

> æ¡ˆä¾‹3çš„å‡½æ•°åŒ…å«äº†ä¸€ä¸ªé¢å¤–çš„å‡½æ•°åŒ…è£…å±‚ã€‚è¿™çœ‹èµ·æ¥æœ‰äº›å¥‡æ€ªè€Œä¸”å¤šä½™ï¼Œä½†å¯¹äºä½ çœŸæ­£è¦é€‚åº”çš„å‡½æ•°å¼ç¼–ç¨‹æ¥è¯´ï¼Œè¿™ä»…ä»…æ˜¯å®ƒçš„å†°å±±ä¸€è§’ã€‚éšç€æœ¬æ–‡çš„ç»§ç»­æ·±å…¥ï¼Œæˆ‘ä»¬å°†ä¼šæŠŠè®¸å¤šå‡½æ•°äº’ç›¸åŒ…è£…èµ·æ¥ã€‚è®°ä½ï¼Œè¿™å°±æ˜¯**å‡½æ•°**å¼ç¼–ç¨‹ï¼

### addæ¡ˆä¾‹

ç†è§£äº†ä¸Šé¢çš„ä¸€ä¸ªæ¡ˆä¾‹ä¹‹åï¼Œæˆ‘ä»¬å†æ¥çœ‹ä¸‹é¢çš„æ¡ˆä¾‹åº”è¯¥å°±ä¼šå˜å¾—éå¸¸ç®€å•äº†ï¼š

è¿™æ˜¯ä¸€ä¸ªè®¡ç®—è¿”å›ä¸¤æ•°ä¹‹å’Œçš„å‡½æ•°ï¼š

```javascript
function add (x, y) {
	return x + y
}
```

ç°åœ¨æˆ‘ä»¬æœ‰ä¸€ä¸ªæ•°ç»„ï¼Œè¦ç»™æ•°ç»„ä¸­çš„æ¯ä¸€é¡¹éƒ½å›ºå®šåŠ ä¸Šä¸€ä¸ªæ•°`3`ï¼Œä¹Ÿè®¸ä½ æƒ³åˆ°äº†å¯ä»¥ç”¨`JS`ä¸­çš„`map`æ¥å†™ï¼š

```javascript
var arr = [1, 2, 3, 4]
var arr2 = arr.map(function adder (val) => {
	return add(3, val)
})
```

`map`ä¸­æ‰§è¡Œçš„äº‹æƒ…å…¶å®ä¹Ÿæ˜¯è¿”å›ä¸€ä¸ªå‡½æ•°`add`çš„è®¡ç®—ç»“æœï¼Œé‚£ä¹ˆæˆ‘ä»¬å°±å¯ä»¥ç”¨`partial`å‡½æ•°æ¥å†™å®ƒï¼š

```javascript
// example4
var arr2 = arr.map(partial(add, 3))
```

**æ³¨æ„ï¼š** å¦‚æœä½ æ²¡è§è¿‡ `map(..)` ï¼Œåˆ«æ‹…å¿ƒï¼Œæˆ‘ä¼šåœ¨åé¢çš„éƒ¨åˆ†è¯¦ç»†ä»‹ç»å®ƒã€‚ç›®å‰ä½ åªéœ€è¦çŸ¥é“å®ƒç”¨æ¥å¾ªç¯éå†ï¼ˆloop overï¼‰ä¸€ä¸ªæ•°ç»„ï¼Œåœ¨éå†è¿‡ç¨‹ä¸­è°ƒç”¨å‡½æ•°äº§å‡ºæ–°å€¼å¹¶å­˜åˆ°æ–°çš„æ•°ç»„ä¸­ã€‚



## æŸ¯é‡ŒåŒ–

æˆ‘ä»¬æ¥çœ‹ä¸€ä¸ªè·Ÿååº”ç”¨ç±»ä¼¼çš„æŠ€æœ¯ï¼Œè¯¥æŠ€æœ¯å°†ä¸€ä¸ªæœŸæœ›æ¥æ”¶å¤šä¸ªå®å‚çš„å‡½æ•°æ‹†è§£æˆè¿ç»­çš„é“¾å¼å‡½æ•°ï¼ˆchained functionsï¼‰ï¼Œæ¯ä¸ªé“¾å¼å‡½æ•°æ¥æ”¶å•ä¸€å®å‚ï¼ˆå®å‚ä¸ªæ•°ï¼š1ï¼‰å¹¶è¿”å›å¦ä¸€ä¸ªæ¥æ”¶ä¸‹ä¸€ä¸ªå®å‚çš„å‡½æ•°ã€‚

è¿™å°±æ˜¯æŸ¯é‡ŒåŒ–ï¼ˆcurryingï¼‰æŠ€æœ¯ã€‚

è¿˜è®°å¾—å‰é¢çš„`ajax`å‡½æ•°å—ï¼Ÿ

```javascript
function ajax (url, data, callback) {
	// ...
}
```

ç°åœ¨æƒ³è±¡ä¸€ä¸‹æˆ‘ä»¬å·²ç»åˆ›å»ºäº†ä¸€ä¸ª`ajax(â€¦)`çš„æŸ¯é‡ŒåŒ–ç‰ˆæœ¬ï¼š

```javascript
curriedAjax('/api/user')
						({ userId: 1 })
							( function foundUser(user) { ... } )	
```

æˆ‘ä»¬å°†ä¸‰æ¬¡è°ƒç”¨åˆ†åˆ«æ‹†è§£å¼€æ¥ï¼Œè¿™ä¹Ÿè®¸æœ‰åŠ©äºæˆ‘ä»¬ç†è§£æ•´ä¸ªè¿‡ç¨‹ï¼š

```javascript
var userFetcher = curriedAjax('/api/user')
var getCurrentUser = userFetcher({ userId: 1 })
getCurrentUser( function foundUser(user){ /* .. */ } )
```

å¯ä»¥çœ‹åˆ°`curriedAjax`å‡½æ•°åœ¨æ¯æ¬¡è°ƒç”¨çš„æ—¶å€™åªæ¥æ”¶ä¸€ä¸ªå®å‚ï¼Œè€Œä¸æ˜¯ä¸€æ¬¡æ€§æ¥æ”¶æ‰€æœ‰å®å‚ï¼ˆåƒ `ajax(..)` é‚£æ ·ï¼‰ï¼Œä¹Ÿä¸æ˜¯å…ˆä¼ éƒ¨åˆ†å®å‚å†ä¼ å‰©ä½™éƒ¨åˆ†å®å‚ï¼ˆå€ŸåŠ© `partial(..)` å‡½æ•°ï¼‰ã€‚

**æŸ¯é‡ŒåŒ–å’Œååº”ç”¨è¿›è¡Œå¯¹æ¯”**ï¼š

ç›¸åŒç‚¹ï¼š

- æ¯ä¸ªç±»ä¼¼ååº”ç”¨çš„è¿ç»­æŸ¯é‡ŒåŒ–è°ƒç”¨éƒ½æŠŠå¦ä¸€ä¸ªå®å‚åº”ç”¨åˆ°åŸå‡½æ•°ï¼Œä¸€ç›´åˆ°æ‰€æœ‰å®å‚ä¼ é€’å®Œæ¯•ã€‚

ä¸åŒç‚¹ï¼š

- æŸ¯é‡ŒåŒ–ä¼šæ˜ç¡®åœ°è¿”å›ä¸€ä¸ªæœŸæœ›**åªæ¥æ”¶ä¸‹ä¸€ä¸ªå®å‚** `data` çš„å‡½æ•°ï¼Œè€Œååº”ç”¨æ˜¯èƒ½æ¥æ”¶æ‰€æœ‰çš„å‰©ä½™å‚æ•°ã€‚

### curryå‡½æ•°

ä¸‹é¢æˆ‘ä»¬æ¥çœ‹çœ‹å¦‚ä½•å®šä¹‰ä¸€ä¸ªç”¨æ¥æŸ¯é‡ŒåŒ–çš„å®ç”¨å‡½æ•°ï¼š

```javascript
function curry(fn, arity = fn.length) {
  return (function nextCurried(prevArgs) {
    return function curried(nextArg) {
      var args = prevArgs.concat([nextArg])
      if (args.length >= arity) {
        return fn(...args)
      } else {
        return nextCurried(args)
      }
    }
  })([])
}
```

`ES6`ç®­å¤´å‡½æ•°ç‰ˆæœ¬ï¼š

```javascript
var curry = (fn, arity = fn.length, nextCurried) => 
  (nextCurried = prevArgs => {
    nextArg => {
      var args = prevArgs.concat( [nextArg] );
      if (args.length >= arity) {
        return fn( ...args );
      }
      else {
        return nextCurried( args );
      }
    }
  })([])
```



> æ­¤å¤„çš„å®ç°æ–¹å¼æ˜¯æŠŠç©ºæ•°ç»„ `[]` å½“ä½œ `prevArgs` çš„åˆå§‹å®å‚é›†åˆï¼Œå¹¶ä¸”å°†æ¯æ¬¡æ¥æ”¶åˆ°çš„ `nextArg` åŒ `prevArgs` è¿æ¥æˆ `args` æ•°ç»„ã€‚å½“ `args.length` å°äº `arity`ï¼ˆåŸå‡½æ•° `fn(..)` è¢«å®šä¹‰å’ŒæœŸæœ›çš„å½¢å‚æ•°é‡ï¼‰æ—¶ï¼Œè¿”å›å¦ä¸€ä¸ª `curried(..)`å‡½æ•°ï¼ˆè¯‘è€…æ³¨ï¼šè¿™é‡ŒæŒ‡ä»£ `nextCurried(..)` è¿”å›çš„å‡½æ•°ï¼‰ç”¨æ¥æ¥æ”¶ä¸‹ä¸€ä¸ª `nextArg` å®å‚ï¼Œä¸æ­¤åŒæ—¶å°† `args` å®å‚é›†åˆä½œä¸ºå”¯ä¸€çš„ `prevArgs` å‚æ•°ä¼ å…¥ `nextCurried(..)` å‡½æ•°ã€‚ä¸€æ—¦æˆ‘ä»¬æ”¶é›†äº†è¶³å¤Ÿé•¿åº¦çš„ `args` æ•°ç»„ï¼Œå°±ç”¨è¿™äº›å®å‚è§¦å‘åŸå‡½æ•° `fn(..)`ã€‚
>
> é»˜è®¤åœ°ï¼Œæˆ‘ä»¬çš„å®ç°æ–¹æ¡ˆåŸºäºä¸‹é¢çš„æ¡ä»¶ï¼šåœ¨æ‹¿åˆ°åŸå‡½æ•°æœŸæœ›çš„å…¨éƒ¨å®å‚ä¹‹å‰ï¼Œæˆ‘ä»¬èƒ½å¤Ÿé€šè¿‡æ£€æŸ¥å°†è¦è¢«æŸ¯é‡ŒåŒ–çš„å‡½æ•°çš„ `length` å±æ€§æ¥å¾—çŸ¥æŸ¯é‡ŒåŒ–éœ€è¦è¿­ä»£å¤šå°‘æ¬¡ã€‚
>
> å‡å¦‚ä½ å°†è¯¥ç‰ˆæœ¬çš„ `curry(..)` å‡½æ•°ç”¨åœ¨ä¸€ä¸ª `length` å±æ€§ä¸æ˜ç¡®çš„å‡½æ•°ä¸Š â€”â€” å‡½æ•°çš„å½¢å‚å£°æ˜åŒ…å«é»˜è®¤å½¢å‚å€¼ã€å½¢å‚è§£æ„ï¼Œæˆ–è€…å®ƒæ˜¯å¯å˜å‚æ•°å‡½æ•°ï¼Œç”¨ `...args` å½“å½¢å‚ï¼›å‚è€ƒç¬¬ 2 ç«  â€”â€” ä½ å°†è¦ä¼ å…¥ `arity` å‚æ•°ï¼ˆä½œä¸º `curry(..)` çš„ç¬¬äºŒä¸ªå½¢å‚ï¼‰æ¥ç¡®ä¿ `curry(..)` å‡½æ•°çš„æ­£å¸¸è¿è¡Œã€‚

### ajaxæ¡ˆä¾‹

æˆ‘ä»¬ç”¨ `curry(..)` å‡½æ•°æ¥å®ç°æ­¤å‰çš„ `ajax(..)` ä¾‹å­ï¼š

```javascript
var curriedAjax = curry( ajax )
var userFetcher = curriedAjax('/api/user')
var getCurrentUser = userFetcher({ userId: 1 })
getCurrentUser( function foundUser(user){ /* .. */ } )
```

å¯ä»¥çœ‹åˆ°åœ¨æ¯æ¬¡å‡½æ•°è°ƒç”¨çš„æ—¶å€™éƒ½ä¼šæ–°å¢ä¸€ä¸ªå®å‚ï¼Œæœ€ç»ˆç»™åŸå‡½æ•°`ajax`ä½¿ç”¨ï¼Œç›´åˆ°æ”¶é½äº†ä¸‰ä¸ªå®å‚å¹¶æ‰§è¡Œ`ajax`å‡½æ•°ä¸ºæ­¢ã€‚

### addæ¡ˆä¾‹

ç°åœ¨æˆ‘ä»¬è¿˜å¯ä»¥æ¥å›é¡¾ä¸€ä¸‹åœ¨`partial`ä¸­ç”¨åˆ°çš„ä¾‹å­ï¼š

```javascript
var arr = [1, 2, 3, 4]
var arr2 = arr.map( partial(add, 3) )
```

ç”±äºæŸ¯é‡ŒåŒ–æ˜¯å’Œååº”ç”¨ç›¸ä¼¼çš„ï¼Œæ‰€ä»¥æˆ‘ä»¬å¯ä»¥ç”¨å‡ ä¹ç›¸åŒçš„æ–¹å¼ä»¥æŸ¯é‡ŒåŒ–æ¥å®Œæˆé‚£ä¸ªä¾‹å­ã€‚

```javascript
var arr2 = arr.map( curry( add )( 3 ) );
// [4,5,6,7,8]
```

`partial(add,3)` å’Œ `curry(add)(3)` ä¸¤è€…æœ‰ä»€ä¹ˆä¸åŒå‘¢ï¼Ÿä¸ºä»€ä¹ˆä½ ä¼šé€‰ `curry(..)` è€Œä¸æ˜¯åå‡½æ•°å‘¢ï¼Ÿå½“ä½ å…ˆå¾—çŸ¥ `add(..)` æ˜¯å°†è¦è¢«è°ƒæ•´çš„å‡½æ•°ï¼Œä½†å¦‚æœè¿™ä¸ªæ—¶å€™å¹¶ä¸èƒ½ç¡®å®š `3` è¿™ä¸ªå€¼ï¼ŒæŸ¯é‡ŒåŒ–å¯èƒ½ä¼šèµ·ä½œç”¨ï¼š

```javascript
var adder = curry( add );

// later
[1,2,3,4,5].map( adder( 3 ) );
// [4,5,6,7,8]
```

### sumæ¡ˆä¾‹

ä¸‹é¢è¿™ä¸ªæ¡ˆä¾‹ï¼Œæ˜¯å°†ä¸€ä¸ªåˆ—è¡¨çš„æ•°å­—ç›¸åŠ ï¼š

```javascript
function sum(...args) {
	var sum = 0;
	for (let i = 0; i < args.length; i++) {
		sum += args[i];
	}
	return sum;
}
```

æ™®é€šè°ƒç”¨ï¼š

```javascript
sum(1, 2, 3, 4, 5)
// 15
```

æŸ¯é‡ŒåŒ–è°ƒç”¨

```javascript
// (5 ç”¨æ¥æŒ‡å®šéœ€è¦é“¾å¼è°ƒç”¨çš„æ¬¡æ•°)
var curriedSum = curry( sum, 5 )
curriedSum( 1 )( 2 )( 3 )( 4 )( 5 ) // 15
```

æŸ¯é‡ŒåŒ–è°ƒç”¨çš„å¥½å¤„ï¼š

- æ¯æ¬¡å‡½æ•°è°ƒç”¨ä¼ å…¥ä¸€ä¸ªå®å‚ï¼Œå¹¶ç”Ÿæˆå¦ä¸€ä¸ªç‰¹å®šæ€§æ›´å¼ºçš„å‡½æ•°ï¼Œä¹‹åæˆ‘ä»¬å¯ä»¥åœ¨ç¨‹åºä¸­è·å–å¹¶ä½¿ç”¨**é‚£ä¸ª**æ–°å‡½æ•°ã€‚
- ååº”ç”¨åˆ™æ˜¯é¢„å…ˆæŒ‡å®šæ‰€æœ‰å°†è¢«ååº”ç”¨çš„å®å‚ï¼Œäº§å‡ºä¸€ä¸ªç­‰å¾…æ¥æ”¶å‰©ä¸‹æ‰€æœ‰å®å‚çš„å‡½æ•°ã€‚

## æŸ¯é‡ŒåŒ–å’Œååº”ç”¨æœ‰ä»€ä¹ˆç”¨ï¼Ÿ

æŸ¯é‡ŒåŒ–å’Œååº”ç”¨è¿™ä¸¤ç§é£æ ¼çš„ç­¾åéƒ½æ¯”æ™®é€šçš„å‡½æ•°è¦å¥‡æ€ªå¾ˆå¤šï¼Œé‚£ä¹ˆä¸ºä»€ä¹ˆè¦ç”¨è¿™ä¹ˆå¥‡æ€ªçš„æ–¹å¼å»æ„é€ é‚£äº›å‡½æ•°å‘¢ï¼Ÿä¸»è¦æ˜¯æœ‰è¿™ä¹ˆå‡ ä¸ªæ–¹é¢ï¼š

- ä½¿ç”¨æŸ¯é‡ŒåŒ–å’Œååº”ç”¨å¯ä»¥å°†æŒ‡å®šåˆ†ç¦»å®å‚çš„æ—¶æœºå’Œåœ°æ–¹ç‹¬ç«‹å¼€æ¥ï¼Œä¼ ç»Ÿå‡½æ•°æ˜¯éœ€è¦é¢„å…ˆç¡®å®šæ‰€æœ‰å®å‚çš„ã€‚
- å½“å‡½æ•°åªæœ‰ä¸€ä¸ªå½¢å‚æ—¶ï¼Œæˆ‘ä»¬èƒ½å¤Ÿæ¯”è¾ƒå®¹æ˜“åœ°ç»„åˆå®ƒä»¬

## æŸ¯é‡ŒåŒ–å¤šä¸ªå‚æ•°

åœ¨ä¸Šé¢ä»‹ç»çš„å‡½æ•°æŸ¯é‡ŒåŒ–ä¸­ï¼Œæˆ‘ä»¬çŸ¥é“ï¼Œå®ƒåœ¨æ¯æ¬¡è°ƒç”¨çš„æ—¶å€™åªæ”¯æŒä¼ å…¥ä¸€ä¸ªå®å‚ã€‚è¿™æ ·çš„æŸ¯é‡ŒåŒ–æˆ‘ä»¬å¯ä»¥ç§°ä¹‹ä¸ºâ€œä¸¥æ ¼æŸ¯é‡ŒåŒ–â€ã€‚

å…¶å®åœ¨å¤§å¤šæ•°æµè¡Œçš„`JavaScript`å‡½æ•°å¼ç¼–ç¨‹éƒ½ä½¿ç”¨äº†ä¸€ç§ä¸ä¸¥æ ¼çš„æŸ¯é‡ŒåŒ–(loose currying)ã€‚

ä¹Ÿå°±æ˜¯è¯´ï¼Œå¾€å¾€ JS æŸ¯é‡ŒåŒ–å®ç”¨å‡½æ•°ä¼šå…è®¸ä½ åœ¨æ¯æ¬¡æŸ¯é‡ŒåŒ–è°ƒç”¨ä¸­æŒ‡å®šå¤šä¸ªå®å‚ï¼Œå¦‚åœ¨ä¸Šé¢æåˆ°çš„`sum`å‡½æ•°ï¼Œæˆ‘ä»¬ä½¿ç”¨ä¸¥æ ¼æŸ¯é‡ŒåŒ–éœ€è¦è°ƒç”¨5æ¬¡ï¼Œä½†åœ¨æ¾æ•£æŸ¯é‡ŒåŒ–æˆ‘ä»¬å¯ä»¥è¿™æ ·ï¼š

```javascript
var curriedSum = looseCurry(sum, 5)
curriedSum(1)(2, 3)(4, 5)
```

ç›¸æ¯”äºä¸¥æ ¼çš„æŸ¯é‡ŒåŒ–ï¼Œè¯­æ³•ä¸Šæˆ‘ä»¬èŠ‚çœäº†`()`çš„ä½¿ç”¨ï¼Œå¹¶ä¸”æŠŠäº”æ¬¡å‡½æ•°è°ƒç”¨å‡å°‘æˆä¸‰æ¬¡ï¼Œé—´æ¥æé«˜äº†æ€§èƒ½ã€‚

**æ³¨æ„ï¼š** æ¾æ•£æŸ¯é‡ŒåŒ–**å…è®¸**ä½ ä¼ å…¥è¶…è¿‡å½¢å‚æ•°é‡ï¼ˆarityï¼ŒåŸå‡½æ•°ç¡®è®¤æˆ–æŒ‡å®šçš„å½¢å‚æ•°é‡ï¼‰çš„å®å‚ã€‚å¦‚æœä½ å°†å‡½æ•°çš„å‚æ•°è®¾è®¡æˆå¯é…çš„æˆ–å˜åŒ–çš„ï¼Œé‚£ä¹ˆæ¾æ•£æŸ¯é‡ŒåŒ–å°†ä¼šæœ‰åˆ©äºä½ ã€‚

ç°åœ¨æˆ‘ä»¬å¯ä»¥å°†ä¹‹å‰çš„æŸ¯é‡ŒåŒ–å‡½æ•°è°ƒæ•´ä¸€ä¸‹ï¼Œä½¿å…¶é€‚åº”è¿™ç§å¸¸è§çš„æ›´æ¾æ•£çš„å®šä¹‰ï¼š

```javascript
function looseCurry(fn, arity = fn.length) {
  return (function nextCurried(prevArgs) {
    return function curried(...nextArgs) {
      var args = prevArgs.concat(nextArgs);
      if (args.length >= arity) {
        return fn(...args);
      } else {
        return nextCurried(args);
      }
    };
  })([]);
}
```

`ES6`ç‰ˆæœ¬ï¼š

```javascript
var looseCurry = (fn, arity = fn.length, nextCurried) =>
  (nextCurried = prevArgs => (...nextArg) => {
    var args = prevArgs.concat(nextArg);
    if (args.length >= arity) {
      return fn(...args);
    } else {
      return nextCurried(args);
    }
  })([]);
```

## åæŸ¯é‡ŒåŒ–

ä½ ä¹Ÿä¼šé‡åˆ°è¿™ç§æƒ…å†µï¼šæ‹¿åˆ°ä¸€ä¸ªæŸ¯é‡ŒåŒ–åçš„å‡½æ•°ï¼Œå´æƒ³è¦å®ƒæŸ¯é‡ŒåŒ–ä¹‹å‰çš„ç‰ˆæœ¬ â€”â€” è¿™æœ¬è´¨ä¸Šå°±æ˜¯æƒ³å°†ç±»ä¼¼ `f(1)(2)(3)` çš„å‡½æ•°å˜å›ç±»ä¼¼ `g(1,2,3)` çš„å‡½æ•°ã€‚

å¤„ç†è¿™ä¸ªéœ€æ±‚çš„æ ‡å‡†å®ç”¨å‡½æ•°é€šå¸¸è¢«å«ä½œ `uncurry(..)`ï¼š

```javascript
function uncurry(fn) {
	return function uncurried(...args){
		var ret = fn;

		for (let i = 0; i < args.length; i++) {
			ret = ret( args[i] );
		}

		return ret;
	};
}
```

`ES6`ç‰ˆæœ¬

```javascript
var uncurry = fn => 
	uncurried = (...args) => {
		var ret = fn
		for (let i = 0; i < args.length; i++) {
			ret = ret( args[i] )
		}
		return ret
	}
```

ä½¿ç”¨åæŸ¯é‡ŒåŒ–åï¼Œå¯ä»¥è®©æˆ‘ä»¬å‡½æ•°çš„ä¼ å‚å½¢å¼å˜ä¸ºæŸ¯é‡ŒåŒ–ä¹‹å‰çš„å½¢å¼ï¼š

```javascript
// example5
function sum(...args) {
	var sum = 0;
	for (let i = 0; i < args.length; i++) {
		sum += args[i];
	}
	return sum;
}

var curriedSum = curry( sum, 5 );
var uncurriedSum = uncurry( curriedSum );

curriedSum( 1 )( 2 )( 3 )( 4 )( 5 );		// 15
uncurriedSum( 1, 2, 3, 4, 5 );				// 15
```

**æ³¨æ„âš ï¸**

ä½†ä¸è¦ä»¥ä¸ºä½¿ç”¨äº†åæŸ¯é‡ŒåŒ–ä¹‹åçš„å‡½æ•°ä¼šå’ŒåŸå‡½æ•°çš„è¡Œä¸ºå®Œå…¨ä¸€æ ·(ä¹Ÿå°±æ˜¯uncurry(curry(fn))å’Œ fn )ï¼Œè™½ç„¶åœ¨æŸäº›åº“ä¸­ï¼ŒåæŸ¯é‡ŒåŒ–ä½¿å‡½æ•°å˜æˆå’ŒåŸå‡½æ•°ï¼ˆè¯‘è€…æ³¨ï¼šè¿™é‡Œçš„åŸå‡½æ•°æŒ‡æŸ¯é‡ŒåŒ–ä¹‹å‰çš„å‡½æ•°ï¼‰ç±»ä¼¼çš„å‡½æ•°ã€‚

ä½†æ˜¯å‡¡äº‹çš†æœ‰ä¾‹å¤–ï¼Œä¾‹å¦‚æˆ‘ä»¬ä¸Šé¢çš„æ¡ˆä¾‹5ï¼Œé‡‡ç”¨åæŸ¯é‡ŒåŒ–ä¹‹åï¼Œå¦‚æœä½ å°‘ä¼ äº†å®å‚ï¼Œå°±ä¼šå¾—åˆ°ä¸€ä¸ªä»ç„¶åœ¨ç­‰å¾…ä¼ å…¥æ›´å¤šå®å‚çš„éƒ¨åˆ†æŸ¯é‡ŒåŒ–å‡½æ•°ã€‚æˆ‘ä»¬åœ¨ä¸‹é¢çš„ä»£ç ä¸­è¯´æ˜è¿™ä¸ªæ€ªå¼‚è¡Œä¸ºã€‚

```javascript
uncurriedSum( 1, 2, 3, 4, 5 ) // 15
uncurriedSum( 1, 2, 3 )( 4, 5 ) // 15
```

è¿™ä¸¤ç§ä¼ å‚æ–¹å¼éƒ½ä¼šå¾—åˆ°ç›¸åŒçš„ç»“æœã€‚

`uncurry()` å‡½æ•°æœ€ä¸ºå¸¸è§çš„ä½œç”¨å¯¹è±¡å¾ˆå¯èƒ½å¹¶ä¸æ˜¯äººä¸ºç”Ÿæˆçš„æŸ¯é‡ŒåŒ–å‡½æ•°ï¼ˆä¾‹å¦‚ä¸Šæ–‡æ‰€ç¤ºï¼‰ï¼Œè€Œæ˜¯æŸäº›æ“ä½œæ‰€äº§ç”Ÿçš„å·²ç»è¢«æŸ¯é‡ŒåŒ–äº†çš„ç»“æœå‡½æ•°ã€‚æˆ‘ä¼šåœ¨åé¢å…³äº â€œæ— å½¢å‚é£æ ¼â€ çš„è®¨è®ºä¸­é˜è¿°è¿™ç§åº”ç”¨åœºæ™¯ã€‚

## åè¯­
åœ¨è¿™ä¸€ç« èŠ‚ä¸­ï¼Œæˆ‘ä¸»è¦ä»‹ç»äº†å‡½æ•°å¼ç¼–ç¨‹ä¸­ä¸¤ä¸ªæ¯”è¾ƒé‡è¦çš„çŸ¥è¯†ç‚¹**ååº”ç”¨**å’Œ**æŸ¯é‡ŒåŒ–**ï¼Œå½»åº•çš„ç†è§£å®ƒä»¬ï¼Œæ‰èƒ½ç»§ç»­æ¥ä¸‹å»çš„å­¦ä¹ ä¹‹è·¯ã€‚

